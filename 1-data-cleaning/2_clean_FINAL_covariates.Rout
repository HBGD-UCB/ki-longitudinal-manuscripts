
R version 4.0.4 (2021-02-15) -- "Lost Library Book"
Copyright (C) 2021 The R Foundation for Statistical Computing
Platform: x86_64-pc-linux-gnu (64-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

  Natural language support but running in an English locale

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

[Previously saved workspace restored]

> 
> #-----------------------------------------------------------------------------------------
> # Process FINAL dataset into a dataset of covariates to be used in the exposure/risk factor
> # analysis in the causes and consequences manuscript. 
> #
> # Output: Single dataset with one row per child and all baseline covariates
> #         Time-varying covariates and anthropometry measures processed in a seperate script.
> #
> # Author: Andrew Mertens (amertens@berkeley.edu)
> #-----------------------------------------------------------------------------------------
> 
> 
> 
> 
> rm(list=ls())
> source(paste0(here::here(), "/0-config.R"))
── Attaching packages ─────────────────────────────────────── tidyverse 1.3.0 ──
✔ ggplot2 3.3.2     ✔ purrr   0.3.4
✔ tibble  3.0.3     ✔ dplyr   1.0.2
✔ tidyr   1.1.1     ✔ stringr 1.4.0
✔ readr   1.3.1     ✔ forcats 0.5.0
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter() masks stats::filter()
✖ dplyr::lag()    masks stats::lag()
here() starts at /home/andrew.mertens/ki-longitudinal-manuscripts

Attaching package: ‘gridExtra’

The following object is masked from ‘package:dplyr’:

    combine


Attaching package: ‘reshape2’

The following object is masked from ‘package:tidyr’:

    smiths

Loading required package: Matrix

Attaching package: ‘Matrix’

The following objects are masked from ‘package:tidyr’:

    expand, pack, unpack

Loading 'metafor' package (version 2.4-0). For an overview 
and introduction to the package please type: help(metafor).

Attaching package: ‘data.table’

The following objects are masked from ‘package:reshape2’:

    dcast, melt

The following objects are masked from ‘package:dplyr’:

    between, first, last

The following object is masked from ‘package:purrr’:

    transpose

Loading required package: viridisLite

Attaching package: ‘maps’

The following object is masked from ‘package:purrr’:

    map


Attaching package: ‘assertthat’

The following object is masked from ‘package:tibble’:

    has_name

Loading required package: nlme

Attaching package: ‘nlme’

The following object is masked from ‘package:dplyr’:

    collapse

This is mgcv 1.8-31. For overview type 'help("mgcv-package")'.

Attaching package: ‘lazyeval’

The following objects are masked from ‘package:purrr’:

    is_atomic, is_formula


Attaching package: ‘rlang’

The following objects are masked from ‘package:lazyeval’:

    as_name, call_modify, call_standardise, expr_label, expr_text,
    f_env, f_env<-, f_label, f_lhs, f_lhs<-, f_rhs, f_rhs<-, f_text,
    is_atomic, is_call, is_formula, is_lang, is_pairlist, missing_arg

The following object is masked from ‘package:assertthat’:

    has_name

The following object is masked from ‘package:data.table’:

    :=

The following objects are masked from ‘package:purrr’:

    %@%, as_function, flatten, flatten_chr, flatten_dbl, flatten_int,
    flatten_lgl, flatten_raw, invoke, list_along, modify, prepend,
    splice


Attaching package: ‘scales’

The following object is masked from ‘package:viridis’:

    viridis_pal

The following object is masked from ‘package:purrr’:

    discard

The following object is masked from ‘package:readr’:

    col_factor


Attaching package: ‘foreach’

The following objects are masked from ‘package:purrr’:

    accumulate, when

Loading required package: iterators
Loading required package: parallel
Loading required package: survival

Attaching package: ‘survey’

The following object is masked from ‘package:graphics’:

    dotchart

Loading required package: bit

Attaching package: ‘bit’

The following object is masked from ‘package:data.table’:

    setattr

The following object is masked from ‘package:base’:

    xor

Attaching package bit64
package:bit64 (c) 2011-2017 Jens Oehlschlaegel
creators: integer64 runif64 seq :
coercion: as.integer64 as.vector as.logical as.integer as.double as.character as.bitstring
logical operator: ! & | xor != == < <= >= >
arithmetic operator: + - * / %/% %% ^
math: sign abs sqrt log log2 log10
math: floor ceiling trunc round
querying: is.integer64 is.vector [is.atomic} [length] format print str
values: is.na is.nan is.finite is.infinite
aggregation: any all min max range sum prod
cumulation: diff cummin cummax cumsum cumprod
access: length<- [ [<- [[ [[<-
combine: c rep cbind rbind as.data.frame
WARNING don't use as subscripts
WARNING semantics differ from integer
for more help type ?bit64

Attaching package: ‘bit64’

The following objects are masked from ‘package:base’:

    :, %in%, is.double, match, order, rank


Attaching package: ‘zoo’

The following objects are masked from ‘package:base’:

    as.Date, as.Date.numeric

Warning messages:
1: package ‘tidyverse’ was built under R version 4.0.5 
2: package ‘rlang’ was built under R version 4.0.5 
> library(growthstandards)
Registered S3 method overwritten by 'pryr':
  method      from
  print.bytes Rcpp
> 
> 
> d <- readRDS(included_studies_path)
> 
> 
> 
> #--------------------------------------------------------
> # Calculate longitudinal prevalence of wasting and stunting
> # in the first 6 months.
> #--------------------------------------------------------
> 
> lprev <- d %>% group_by(studyid, country, subjid) %>%
+   #only keep it in monthly studies
+   filter(measurefreq=="monthly") %>%
+   filter(agedays<6*30.4167) %>%
+   mutate(wast=as.numeric(whz < -2), stunt=as.numeric(haz < -2)) %>%
+   summarize(N=n(), wastprev06=mean(wast, na.rm=T), stuntprev06=mean(stunt, na.rm=T), anywast06=as.numeric(wastprev06>0), anystunt06=as.numeric(stuntprev06>0), 
+             pers_wast=as.numeric(wastprev06>=0.5)) %>%
+   mutate(pers_wast=ifelse(N>=4,pers_wast,NA))
`summarise()` regrouping output by 'studyid', 'country' (override with `.groups` argument)
> head(lprev)
# A tibble: 6 x 9
# Groups:   studyid, country [1]
  studyid country subjid     N wastprev06 stuntprev06 anywast06 anystunt06
  <chr>   <chr>    <dbl> <int>      <dbl>       <dbl>     <dbl>      <dbl>
1 CMC-V-… INDIA        1    15        0.4       0.8           1          1
2 CMC-V-… INDIA        2    38        0         0             0          0
3 CMC-V-… INDIA        3    33        0         0             0          0
4 CMC-V-… INDIA        4    53        0.8       0             1          0
5 CMC-V-… INDIA        5    13        0.5       0.833         1          1
6 CMC-V-… INDIA        6    36        0         1             0          1
# … with 1 more variable: pers_wast <dbl>
> 
> table(lprev$anywast06)

   0    1 
8368 2559 
> table(lprev$anystunt06)

   0    1 
7500 3455 
> table(lprev$pers_wast)

   0    1 
9731  480 
> 
> #Merge in new variables
> lprev <- lprev %>% subset(., select = c(studyid, country,subjid, anywast06,  pers_wast))
> 
> dim(d)
[1] 8337540      95
> d <- left_join(d, lprev, by=c("studyid","country","subjid"))
> dim(d)
[1] 8337540      97
> 
> 
> 
> 
> #--------------------------------------------------------
> # Calculate birth month and month from birth week if birthmonth is missing
> #--------------------------------------------------------
> 
> #fill in missing birthmonth
> table(d$brthmon)

     1      2      3      4      5      6      7      8      9     10     11 
520299 737863 790707 639251 565323 489519 585444 608818 595010 522581 513631 
    12 
524257 
> d$brthmon[is.na(d$brthmon)] <- ceiling(d$brthweek[is.na(d$brthmon)]/4.42)
> table(d$brthmon)

     1      2      3      4      5      6      7      8      9     10     11 
525184 742537 796128 642851 569145 492757 587795 613213 599499 527996 517833 
    12 
528665 
> 
> #fill in missing month if brthmonth is present
> table(d$month)

     1      2      3      4      5      6      7      8      9     10     11 
612044 561576 611699 573828 587313 568327 591214 579605 590122 615262 595700 
    12 
606013 
> d$month[is.na(d$month) & !is.na(d$brthmon)] <- floor(d$brthmon[is.na(d$month) & !is.na(d$brthmon)] + d$agedays[is.na(d$month)& !is.na(d$brthmon)]/30.4167) %% 12 +1
> table(d$month)

     1      2      3      4      5      6      7      8      9     10     11 
615715 565714 615765 577804 591477 572620 595699 584084 594707 619804 600121 
    12 
610093 
> 
> 
> #--------------------------------------------------------
> #Calculate stunting and wasting at enrollment and keep one observation per child
> #Also check if children without a recorded birthweight or birthlength have WAZ or HAZ in the first year of life
> #--------------------------------------------------------
> d <- d %>% group_by(studyid, subjid) %>% 
+   arrange(studyid, subjid, agedays) %>% 
+   mutate(enstunt= as.numeric(haz < -2),
+          enwast= as.numeric(whz < -2),
+          birthLAZ= haz,
+          birthWAZ= waz) %>%
+   #keep one observation per child
+   slice(1) 
> 
> table(is.na(d$birthwt), d$agedays > 7)
       
        FALSE  TRUE
  FALSE 64522  1929
  TRUE   6745 26801
> 
> #keep where anthro is measured on first 7 days, but birth anthro is not recorded
> d$birthLAZ[d$agedays>7] <- NA 
> d$birthWAZ[d$agedays>7] <- NA
> d$birthmeas_age <- NA
> d$birthmeas_age[d$agedays <= 7] <- d$agedays[d$agedays <= 7]
> 
> #Drop anthropometry measures (seperate long-form dataset used to calculate anthropometry outcomes)
> d <- d %>% subset(., select=-c(agedays, haz, waz, whz)) 
> 
> table(d$studyid, d$enwast)
                   
                        0     1
  Burkina Faso Zn    6498  1091
  CMC-V-BCS-2002       79    12
  CMIN Bangladesh93     5     3
  CMIN Brazil89       103     8
  CMIN GB94           377     8
  CMIN Peru89          33     0
  CMIN Peru95          48     1
  CONTENT              55     0
  EE                    0     0
  GMS-Nepal           104    20
  Guatemala BSC       304     6
  iLiNS-DOSE         1823    27
  iLiNS-DYAD-M         67     9
  iLiNS-Zinc         2635   536
  IRC                 252   113
  JiVitA-3          19503  2459
  JiVitA-4           3615   370
  Keneba             1832   460
  LCNI-5              801    14
  MAL-ED               46     5
  NIH-Birth           421   175
  NIH-Crypto           20     3
  PROBIT            10903  2979
  PROVIDE               0     0
  ResPak              223    48
  SAS-CompFeed       1215   152
  SAS-FoodSuppl       331    73
  TanzaniaChild2       20     0
  TDC                  18     3
  VITAMIN-A             0     0
  ZVITAMBO          10856  2237
> table(d$studyid, d$enstunt)
                   
                        0     1
  Burkina Faso Zn    5494  2095
  CMC-V-BCS-2002       78    18
  CMIN Bangladesh93     7     6
  CMIN Brazil89       110     5
  CMIN GB94           332    55
  CMIN Peru89          32     1
  CMIN Peru95          48     1
  CONTENT              48     7
  EE                    0     0
  GMS-Nepal           113    27
  Guatemala BSC       234    76
  iLiNS-DOSE         1303   547
  iLiNS-DYAD-M         61    18
  iLiNS-Zinc         2462   709
  IRC                 344    48
  JiVitA-3          17902  8687
  JiVitA-4           3176  1288
  Keneba             2136   223
  LCNI-5              518   297
  MAL-ED               45     9
  NIH-Birth           525    99
  NIH-Crypto           22     5
  PROBIT            13855    34
  PROVIDE               0     0
  ResPak              202    82
  SAS-CompFeed       1086   441
  SAS-FoodSuppl       250   154
  TanzaniaChild2       19     1
  TDC                  19     3
  VITAMIN-A             0     0
  ZVITAMBO          12442  1507
> 
> 
> 
> #--------------------------------------------------------
> #Merge in birthmonth from provide
> #--------------------------------------------------------
> 
> gc()
           used  (Mb) gc trigger    (Mb)   max used    (Mb)
Ncells  2560976 136.8    4026378   215.1    4026378   215.1
Vcells 12454302  95.1 1713806162 13075.4 1485900678 11336.6
> d$subjid <- as.numeric(d$subjid)
> gc()
           used  (Mb) gc trigger    (Mb)   max used    (Mb)
Ncells  2560961 136.8    4026378   215.1    4026378   215.1
Vcells 12452058  95.1 1371044930 10460.3 1485900678 11336.6
> 
> 
> provide <- readRDS(paste0(ghapdata_dir, "covariate creation intermediate datasets/derived covariate datasets/PROVIDE_birthmonth.rds"))
> provide$studyid <- "PROVIDE"
> provide$birthmon_provide <- as.numeric(as.character(provide$birthmon_provide))
> 
> unique(d$studyid)
 [1] "Burkina Faso Zn"   "CMC-V-BCS-2002"    "CMIN Bangladesh93"
 [4] "CMIN Brazil89"     "CMIN GB94"         "CMIN Peru89"      
 [7] "CMIN Peru95"       "CONTENT"           "EE"               
[10] "GMS-Nepal"         "Guatemala BSC"     "iLiNS-DOSE"       
[13] "iLiNS-DYAD-M"      "iLiNS-Zinc"        "IRC"              
[16] "JiVitA-3"          "JiVitA-4"          "Keneba"           
[19] "LCNI-5"            "MAL-ED"            "NIH-Birth"        
[22] "NIH-Crypto"        "PROBIT"            "PROVIDE"          
[25] "ResPak"            "SAS-CompFeed"      "SAS-FoodSuppl"    
[28] "TanzaniaChild2"    "TDC"               "VITAMIN-A"        
[31] "ZVITAMBO"         
> table(is.na(d$brthmon[d$studyid=="PROVIDE"]))

TRUE 
 700 
> d <- left_join(d, provide, by = c("studyid", "subjid"))
> table(d$birthmon_provide)

 1  2  3  4  5  6  7  8  9 10 11 12 
38 35 53 39 52 94 92 69 76 79 42 31 
> d$brthmon[d$studyid=="PROVIDE"] <- d$birthmon_provide[d$studyid=="PROVIDE"]
> table(is.na(d$brthmon[d$studyid=="PROVIDE"]))

FALSE 
  700 
> table((d$brthmon[d$studyid=="PROVIDE"]))

 1  2  3  4  5  6  7  8  9 10 11 12 
38 35 53 39 52 94 92 69 76 79 42 31 
> d <- d %>% subset(., select = -c(birthmon_provide))
> 
> 
> #--------------------------------------------------------
> # Merge in household assets-based wealth index
> # (Calculated from first principal component of a PCA analysis)
> # of asset indicators
> #--------------------------------------------------------
> 
> #convert subjid to character for the merge with covariate dataset
> d$subjid <- as.character(d$subjid)
> 
> #load in pca results
> pca <- readRDS(paste0(deriveddata_dir,"allGHAPstudies-HHwealth.rds"))
> 
> #Strip grant identifiers from study id's
> pca$studyid<- gsub("^k.*?-" , "", pca$studyid)
> 
> table(pca$studyid, pca$hhwealth_quart)
                
                 Wealth Q1 Wealth Q2 Wealth Q3 Wealth Q4
  AgaKhanUniv          174       170       171       172
  CMC-V-BCS-2002        91        95        91        96
  CONTENT               52        47        56        60
  GMS-Nepal            175       174       174       175
  iLiNS-DOSE           470       470       469       470
  iLiNS-DYAD-M         310       312       311       312
  IRC                  105       102       103       100
  JiVitA-3           11131     11184     11120     11272
  JiVitA-4            1355      1361      1358      1359
  LCNI-5               227       183       214       193
  MAL-ED               427       423       424       428
  PROVIDE              175       175       169       181
  TanzaniaChild2       780       610       433       565
  TDC                   40        40        40        40
> 
> #Merge into main dataframe
> pca <- as.data.frame(pca)
> pca$subjid <-as.character(pca$subjid)
> 
> dim(pca)
[1] 62856     4
> dim(d)
[1] 99997    98
> d <- left_join(d, pca, by=c("studyid", "country", "subjid"))
> dim(d)
[1] 99997    99
> #Note, only the COHORTS study has SES categories from a PCA, but no/incomplete indicators to calculate PCA from
> #Clean and merge that data here:
> #merge in ses variable for COHORTS for all countries except INDIA. The other countries have wealth based on 
> #an asset-based PCA index, but India is based on father's occupation.
> d$hhwealth_quart <- as.character(d$hhwealth_quart)
> chtses<- d$ses[is.na(d$hhwealth_quart) & d$studyid=="COHORTS" & d$country!="INDIA"]
> chtses[chtses==""] <- NA
> chtses[chtses=="Low"] <- "Wealth Q1"
> chtses[chtses=="Lower-mi"] <- "Wealth Q2"
> chtses[chtses=="Middle"] <- "Wealth Q3"
> chtses[chtses=="Upper-mi"] <- "Wealth Q4"
> chtses[chtses=="Upper"] <- "Wealth Q4"
> 
> d$hhwealth_quart[is.na(d$hhwealth_quart) & d$studyid=="COHORTS" & d$country!="INDIA"] <-chtses
> d$hhwealth_quart <- factor(d$hhwealth_quart)
> 
> #Check and make sure all merged correctly
> df <- d %>% filter(!is.na(hhwealth_quart)) %>% group_by(studyid, subjid) %>% slice(1)
> pca_unique <- pca %>% filter(!is.na(hhwealth_quart)) %>% group_by(studyid, subjid) %>% slice(1)
> table(pca_unique$studyid, pca_unique$hhwealth_quart)
                
                 Wealth Q1 Wealth Q2 Wealth Q3 Wealth Q4
  AgaKhanUniv          174       170       171       172
  CMC-V-BCS-2002        91        95        91        96
  CONTENT               52        47        56        60
  GMS-Nepal            175       174       174       175
  iLiNS-DOSE           470       470       469       470
  iLiNS-DYAD-M         310       312       311       312
  IRC                  105       102       103       100
  JiVitA-3           11131     11184     11120     11272
  JiVitA-4            1355      1361      1358      1359
  LCNI-5               227       183       214       193
  MAL-ED               427       423       424       428
  PROVIDE              175       175       169       181
  TanzaniaChild2       780       610       433       565
  TDC                   40        40        40        40
> table(df$studyid, df$hhwealth_quart)
                
                 Wealth Q1 Wealth Q2 Wealth Q3 Wealth Q4
  CMC-V-BCS-2002        91        95        91        96
  CONTENT               52        47        56        60
  GMS-Nepal            175       174       174       175
  iLiNS-DOSE           470       470       469       470
  iLiNS-DYAD-M         310       312       310       312
  IRC                  105       102       103       100
  JiVitA-3            6836      6941      7011      7486
  JiVitA-4            1355      1361      1358      1359
  LCNI-5               227       183       214       193
  MAL-ED               427       423       424       428
  PROVIDE              175       175       169       181
  TanzaniaChild2       780       610       433       565
  TDC                   40        40        40        40
> 
> #remove space for longbow
> d$hhwealth_quart <- as.character(d$hhwealth_quart)
> d$hhwealth_quart <- gsub(" ", "", d$hhwealth_quart)
> d$hhwealth_quart <- factor(d$hhwealth_quart, levels=c("WealthQ4","WealthQ3","WealthQ2","WealthQ1"))
> table(d$hhwealth_quart)

WealthQ4 WealthQ3 WealthQ2 WealthQ1 
   11465    10852    10933    11043 
> 
> #--------------------------------------------------------------------------
> # Code Food security
> #--------------------------------------------------------------------------
> 
> #Code into 3 harmonized categories (so that all 3 levels are present across all studies)
> # By recoding the levels from the HHS, HFAIS, and FAST scales into 3 categories
> table(d$studyid, d$hfoodsec)
                   
                          Deficit in whole year Deficit In Whole Year
  Burkina Faso Zn    7640                     0                     0
  CMC-V-BCS-2002      373                     0                     0
  CMIN Bangladesh93   280                     0                     0
  CMIN Brazil89       119                     0                     0
  CMIN GB94           885                     0                     0
  CMIN Peru89         210                     0                     0
  CMIN Peru95         224                     0                     0
  CONTENT             288                     0                     0
  EE                  380                     0                     0
  GMS-Nepal            24                     0                     0
  Guatemala BSC       315                     0                     0
  iLiNS-DOSE          147                     0                     0
  iLiNS-DYAD-M        526                     0                     0
  iLiNS-Zinc         3266                     0                     0
  IRC                 410                     0                     0
  JiVitA-3          10891                     0                     0
  JiVitA-4             44                     0                     0
  Keneba             2954                     0                     0
  LCNI-5              840                     0                     0
  MAL-ED              859                     0                     0
  NIH-Birth             0                     6                     0
  NIH-Crypto            0                     0                    24
  PROBIT            17046                     0                     0
  PROVIDE             700                     0                     0
  ResPak              561                     0                     0
  SAS-CompFeed       1535                     0                     0
  SAS-FoodSuppl       418                     0                     0
  TanzaniaChild2     2400                     0                     0
  TDC                   0                     0                     0
  VITAMIN-A          4000                     0                     0
  ZVITAMBO          14110                     0                     0
                   
                    Food Insecure Food secure Food Secure Mildly Food Insecure
  Burkina Faso Zn               0           0           0                    0
  CMC-V-BCS-2002                0           0           0                    0
  CMIN Bangladesh93             0           0           0                    0
  CMIN Brazil89                 0           0           0                    0
  CMIN GB94                     0           0           0                    0
  CMIN Peru89                   0           0           0                    0
  CMIN Peru95                   0           0           0                    0
  CONTENT                       0           0           0                    0
  EE                            0           0           0                    0
  GMS-Nepal                     0           0         479                    0
  Guatemala BSC                 0           0           0                    0
  iLiNS-DOSE                    0           0         400                    0
  iLiNS-DYAD-M                  0           0         204                    0
  iLiNS-Zinc                    0           0           0                    0
  IRC                           0           0           0                    0
  JiVitA-3                   2910        8711           0                 5793
  JiVitA-4                    703        2751           0                 1951
  Keneba                        0           0           0                    0
  LCNI-5                        0           0           0                    0
  MAL-ED                        0           0         607                    0
  NIH-Birth                     0           0           0                    0
  NIH-Crypto                    0           0           0                    0
  PROBIT                        0           0           0                    0
  PROVIDE                       0           0           0                    0
  ResPak                        0           0           0                    0
  SAS-CompFeed                  0           0           0                    0
  SAS-FoodSuppl                 0           0           0                    0
  TanzaniaChild2                0           0           0                    0
  TDC                           0           0           0                    0
  VITAMIN-A                     0           0           0                    0
  ZVITAMBO                      0           0           0                    0
                   
                    Mildly Food Insecure Access Moderately Food Insecure Access
  Burkina Faso Zn                             0                               0
  CMC-V-BCS-2002                              0                               0
  CMIN Bangladesh93                           0                               0
  CMIN Brazil89                               0                               0
  CMIN GB94                                   0                               0
  CMIN Peru89                                 0                               0
  CMIN Peru95                                 0                               0
  CONTENT                                     0                               0
  EE                                          0                               0
  GMS-Nepal                                 106                              63
  Guatemala BSC                               0                               0
  iLiNS-DOSE                                149                             392
  iLiNS-DYAD-M                              131                             180
  iLiNS-Zinc                                  0                               0
  IRC                                         0                               0
  JiVitA-3                                    0                               0
  JiVitA-4                                    0                               0
  Keneba                                      0                               0
  LCNI-5                                      0                               0
  MAL-ED                                     83                             214
  NIH-Birth                                   0                               0
  NIH-Crypto                                  0                               0
  PROBIT                                      0                               0
  PROVIDE                                     0                               0
  ResPak                                      0                               0
  SAS-CompFeed                                0                               0
  SAS-FoodSuppl                               0                               0
  TanzaniaChild2                              0                               0
  TDC                                         0                               0
  VITAMIN-A                                   0                               0
  ZVITAMBO                                    0                               0
                   
                    Neither deficit nor surplus Neither Deficit Nor Surplus
  Burkina Faso Zn                             0                           0
  CMC-V-BCS-2002                              0                           0
  CMIN Bangladesh93                           0                           0
  CMIN Brazil89                               0                           0
  CMIN GB94                                   0                           0
  CMIN Peru89                                 0                           0
  CMIN Peru95                                 0                           0
  CONTENT                                     0                           0
  EE                                          0                           0
  GMS-Nepal                                   0                           0
  Guatemala BSC                               0                           0
  iLiNS-DOSE                                  0                           0
  iLiNS-DYAD-M                                0                           0
  iLiNS-Zinc                                  0                           0
  IRC                                         0                           0
  JiVitA-3                                    0                           0
  JiVitA-4                                    0                           0
  Keneba                                      0                           0
  LCNI-5                                      0                           0
  MAL-ED                                      0                           0
  NIH-Birth                                 492                           0
  NIH-Crypto                                  0                         219
  PROBIT                                      0                           0
  PROVIDE                                     0                           0
  ResPak                                      0                           0
  SAS-CompFeed                                0                           0
  SAS-FoodSuppl                               0                           0
  TanzaniaChild2                              0                           0
  TDC                                         0                           0
  VITAMIN-A                                   0                           0
  ZVITAMBO                                    0                           0
                   
                    Severely Food Insecure Access Sometimes deficit
  Burkina Faso Zn                               0                 0
  CMC-V-BCS-2002                                0                 0
  CMIN Bangladesh93                             0                 0
  CMIN Brazil89                                 0                 0
  CMIN GB94                                     0                 0
  CMIN Peru89                                   0                 0
  CMIN Peru95                                   0                 0
  CONTENT                                       0                 0
  EE                                            0                 0
  GMS-Nepal                                    26                 0
  Guatemala BSC                                 0                 0
  iLiNS-DOSE                                  844                 0
  iLiNS-DYAD-M                                203                 0
  iLiNS-Zinc                                    0                 0
  IRC                                           0                 0
  JiVitA-3                                      0                 0
  JiVitA-4                                      0                 0
  Keneba                                        0                 0
  LCNI-5                                        0                 0
  MAL-ED                                      105                 0
  NIH-Birth                                     0                36
  NIH-Crypto                                    0                 0
  PROBIT                                        0                 0
  PROVIDE                                       0                 0
  ResPak                                        0                 0
  SAS-CompFeed                                  0                 0
  SAS-FoodSuppl                                 0                 0
  TanzaniaChild2                                0                 0
  TDC                                           0                 0
  VITAMIN-A                                     0                 0
  ZVITAMBO                                      0                 0
                   
                    Sometimes Deficit Surplus
  Burkina Faso Zn                   0       0
  CMC-V-BCS-2002                    0       0
  CMIN Bangladesh93                 0       0
  CMIN Brazil89                     0       0
  CMIN GB94                         0       0
  CMIN Peru89                       0       0
  CMIN Peru95                       0       0
  CONTENT                           0       0
  EE                                0       0
  GMS-Nepal                         0       0
  Guatemala BSC                     0       0
  iLiNS-DOSE                        0       0
  iLiNS-DYAD-M                      0       0
  iLiNS-Zinc                        0       0
  IRC                               0       0
  JiVitA-3                          0       0
  JiVitA-4                          0       0
  Keneba                            0       0
  LCNI-5                            0       0
  MAL-ED                            0       0
  NIH-Birth                         0      95
  NIH-Crypto                       62     453
  PROBIT                            0       0
  PROVIDE                           0       0
  ResPak                            0       0
  SAS-CompFeed                      0       0
  SAS-FoodSuppl                     0       0
  TanzaniaChild2                    0       0
  TDC                               0       0
  VITAMIN-A                         0       0
  ZVITAMBO                          0       0
> unique(d$hfoodsec)
 [1] ""                                "Mildly Food Insecure Access"    
 [3] "Food Secure"                     "Severely Food Insecure Access"  
 [5] "Moderately Food Insecure Access" "Mildly Food Insecure"           
 [7] "Food secure"                     "Food Insecure"                  
 [9] "Neither deficit nor surplus"     "Surplus"                        
[11] "Sometimes deficit"               "Deficit in whole year"          
[13] "Neither Deficit Nor Surplus"     "Sometimes Deficit"              
[15] "Deficit In Whole Year"           NA                               
> 
> d$temp <- NA
> d$temp[d$hfoodsec=="Mildly Food Insecure"] <- "Mildly Food Insecure"
> d$temp[d$hfoodsec=="Food Insecure"] <- "Food Insecure"
> d$temp[d$hfoodsec=="Food secure"] <- "Food Secure"
> 
> d$temp[d$hfoodsec=="Neither Deficit Nor Surplus"] <- "Mildly Food Insecure"
> d$temp[d$hfoodsec=="Sometimes Deficit"] <- "Food Insecure"
> d$temp[d$hfoodsec=="Deficit In Whole Year"] <- "Food Insecure"
> d$temp[d$hfoodsec=="Surplus"] <- "Food Secure"
> 
> d$temp[d$hfoodsec=="Neither deficit nor surplus"] <- "Mildly Food Insecure"
> d$temp[d$hfoodsec=="Sometimes deficit"] <- "Food Insecure"
> d$temp[d$hfoodsec=="Deficit in whole year"] <- "Food Insecure"
> 
> d$temp[d$hfoodsec=="Mildly Food Insecure Access"] <- "Mildly Food Insecure"
> d$temp[d$hfoodsec=="Moderately Food Insecure Access"] <- "Food Insecure"
> d$temp[d$hfoodsec=="Severely Food Insecure Access"] <- "Food Insecure"
> d$temp[d$hfoodsec=="Food Secure"] <- "Food Secure"
> 
> table(d$studyid[!is.na(d$temp)], d$temp[!is.na(d$temp)])
              
               Food Insecure Food Secure Mildly Food Insecure
  GMS-Nepal               89         479                  106
  iLiNS-DOSE            1236         400                  149
  iLiNS-DYAD-M           383         204                  131
  JiVitA-3              2910        8711                 5793
  JiVitA-4               703        2751                 1951
  MAL-ED                 319         607                   83
  NIH-Birth               42          95                  492
  NIH-Crypto              86         453                  219
> 
> 
> d$hfoodsec <- d$temp
> d <- d %>% subset(., select=-c(temp))
> 
> table(d$studyid, d$hfoodsec)
                   
                    Food Insecure Food Secure Mildly Food Insecure
  Burkina Faso Zn               0           0                    0
  CMC-V-BCS-2002                0           0                    0
  CMIN Bangladesh93             0           0                    0
  CMIN Brazil89                 0           0                    0
  CMIN GB94                     0           0                    0
  CMIN Peru89                   0           0                    0
  CMIN Peru95                   0           0                    0
  CONTENT                       0           0                    0
  EE                            0           0                    0
  GMS-Nepal                    89         479                  106
  Guatemala BSC                 0           0                    0
  iLiNS-DOSE                 1236         400                  149
  iLiNS-DYAD-M                383         204                  131
  iLiNS-Zinc                    0           0                    0
  IRC                           0           0                    0
  JiVitA-3                   2910        8711                 5793
  JiVitA-4                    703        2751                 1951
  Keneba                        0           0                    0
  LCNI-5                        0           0                    0
  MAL-ED                      319         607                   83
  NIH-Birth                    42          95                  492
  NIH-Crypto                   86         453                  219
  PROBIT                        0           0                    0
  PROVIDE                       0           0                    0
  ResPak                        0           0                    0
  SAS-CompFeed                  0           0                    0
  SAS-FoodSuppl                 0           0                    0
  TanzaniaChild2                0           0                    0
  TDC                           0           0                    0
  VITAMIN-A                     0           0                    0
  ZVITAMBO                      0           0                    0
> 
> d$hfoodsec <- factor(d$hfoodsec, levels=c("Food Secure", "Mildly Food Insecure", "Food Insecure"))
> 
> 
> 
> #--------------------------------------------------------------------------
> # birth characteristics
> #--------------------------------------------------------------------------
> 
> 
> # drop gestational age in studies with no variations (measured it at the month level)
> d$gagebrth[d$studyid=="GMS-Nepal"] <- NA
> #drop gestational age in study where GA is mother reported and unbelievably high (93% and 80% preterm)
> d$gagebrth[d$studyid=="SAS-CompFeed"] <- NA
> d$gagebrth[d$studyid=="EE"] <- NA
> 
> 
> #parity
> #Combine parity and birthorder to have sufficient data to analyze
> #Parity (which includes stillborns past a certain gestational age) is assumed
> #to approximate child birth order
> table(d$studyid[!is.na(d$parity)], d$parity[!is.na(d$parity)])
                 
                      1     2     3     4     5     6     7     8     9    10
  Burkina Faso Zn  1321  1197   994  1355     0  1095     0     0   283     0
  GMS-Nepal         211   181   128    89    48    19     5     9     4     3
  iLiNS-DYAD-M        0   224   281   273   206   160    67    24     6     3
  JiVitA-3            0 10850  9236  4843  2076   787   304   130    44    19
  Keneba              0   241   215   233   238   223   231   173   125   129
  PROVIDE           271   244   103    50    21     6     3     1     0     1
  TanzaniaChild2    843   776   459   188    71    22     5     2     0     0
  ZVITAMBO         6088  4220  2001   970   465   220    90    30    14    10
                 
                     11    12    13    14    15    16    17    20
  Burkina Faso Zn     0     0     0     0     0     0     0     0
  GMS-Nepal           1     0     0     0     0     0     0     0
  iLiNS-DYAD-M        0     0     0     0     0     0     0     0
  JiVitA-3            9     5     1     0     1     0     0     0
  Keneba             94    54    30     6     4     2     0     2
  PROVIDE             0     0     0     0     0     0     0     0
  TanzaniaChild2      0     0     0     0     0     0     1     0
  ZVITAMBO            1     0     0     0     0     0     0     0
> table(d$studyid[!is.na(d$brthordr)], d$brthordr[!is.na(d$brthordr)])
               
                  0   1   2   3   4   5   6   7   8   9  10  12
  SAS-CompFeed    0 453 361 316 188 113  55  19  20   8   1   1
  SAS-FoodSuppl  21  77  92  74  54  58  23  11   5   1   2   0
  TDC             0  48  64  39   7   2   0   0   0   0   0   0
> 
> d$parity[is.na(d$parity)] <- d$brthordr[is.na(d$parity)]
> d$parity[is.na(d$parity)] <- d$gravida[is.na(d$parity)]
> 
> 
> #Shift obs in SAS-FoodSuppl to make 1==firstborn
> d$parity[d$studyid=="SAS-FoodSuppl"] <- d$parity[d$studyid=="SAS-FoodSuppl"] + 1   
> 
> #Fix right shift of Tanzania child, Kenaba, iLiNS-DYAD-M, and Jivita-3 parity
> d$parity[d$studyid=="TanzaniaChild2" & d$parity==1] <- NA
> d$parity[d$studyid=="TanzaniaChild2"] <- d$parity[d$studyid=="TanzaniaChild2"] - 1  
> d$parity[d$studyid=="Keneba"] <- d$parity[d$studyid=="Keneba"] - 1  
> d$parity[d$studyid=="iLiNS-DYAD-M"] <- d$parity[d$studyid=="iLiNS-DYAD-M"] - 1  
> d$parity[d$studyid=="JiVitA-3"] <- d$parity[d$studyid=="JiVitA-3"] - 1  
> table(d$studyid, d$parity)
                   
                        1     2     3     4     5     6     7     8     9    10
  Burkina Faso Zn    1321  1197   994  1355     0  1095     0     0   283     0
  CMC-V-BCS-2002        0     0     0     0     0     0     0     0     0     0
  CMIN Bangladesh93     0     0     0     0     0     0     0     0     0     0
  CMIN Brazil89         0     0     0     0     0     0     0     0     0     0
  CMIN GB94             0     0     0     0     0     0     0     0     0     0
  CMIN Peru89           0     0     0     0     0     0     0     0     0     0
  CMIN Peru95           0     0     0     0     0     0     0     0     0     0
  CONTENT               0     0     0     0     0     0     0     0     0     0
  EE                    0     0     0     0     0     0     0     0     0     0
  GMS-Nepal           211   181   128    89    48    19     5     9     4     3
  Guatemala BSC         0     0     0     0     0     0     0     0     0     0
  iLiNS-DOSE            0     0     0     0     0     0     0     0     0     0
  iLiNS-DYAD-M        224   281   273   206   160    67    24     6     3     0
  iLiNS-Zinc            0     0     0     0     0     0     0     0     0     0
  IRC                   0     0     0     0     0     0     0     0     0     0
  JiVitA-3          10850  9236  4843  2076   787   304   130    44    19     9
  JiVitA-4              0     0     0     0     0     0     0     0     0     0
  Keneba              241   215   233   238   223   231   173   125   129    94
  LCNI-5                0     0     0     0     0     0     0     0     0     0
  MAL-ED                0     0     0     0     0     0     0     0     0     0
  NIH-Birth             0     0     0     0     0     0     0     0     0     0
  NIH-Crypto            0     0     0     0     0     0     0     0     0     0
  PROBIT                0     0     0     0     0     0     0     0     0     0
  PROVIDE             271   244   103    50    21     6     3     1     0     1
  ResPak                0     0     0     0     0     0     0     0     0     0
  SAS-CompFeed        453   361   316   188   113    55    19    20     8     1
  SAS-FoodSuppl        21    77    92    74    54    58    23    11     5     1
  TanzaniaChild2      776   459   188    71    22     5     2     0     0     0
  TDC                  48    64    39     7     2     0     0     0     0     0
  VITAMIN-A             0     0     0     0     0     0     0     0     0     0
  ZVITAMBO           6088  4220  2001   970   465   220    90    30    14    10
                   
                       11    12    13    14    15    16    19
  Burkina Faso Zn       0     0     0     0     0     0     0
  CMC-V-BCS-2002        0     0     0     0     0     0     0
  CMIN Bangladesh93     0     0     0     0     0     0     0
  CMIN Brazil89         0     0     0     0     0     0     0
  CMIN GB94             0     0     0     0     0     0     0
  CMIN Peru89           0     0     0     0     0     0     0
  CMIN Peru95           0     0     0     0     0     0     0
  CONTENT               0     0     0     0     0     0     0
  EE                    0     0     0     0     0     0     0
  GMS-Nepal             1     0     0     0     0     0     0
  Guatemala BSC         0     0     0     0     0     0     0
  iLiNS-DOSE            0     0     0     0     0     0     0
  iLiNS-DYAD-M          0     0     0     0     0     0     0
  iLiNS-Zinc            0     0     0     0     0     0     0
  IRC                   0     0     0     0     0     0     0
  JiVitA-3              5     1     0     1     0     0     0
  JiVitA-4              0     0     0     0     0     0     0
  Keneba               54    30     6     4     2     0     2
  LCNI-5                0     0     0     0     0     0     0
  MAL-ED                0     0     0     0     0     0     0
  NIH-Birth             0     0     0     0     0     0     0
  NIH-Crypto            0     0     0     0     0     0     0
  PROBIT                0     0     0     0     0     0     0
  PROVIDE               0     0     0     0     0     0     0
  ResPak                0     0     0     0     0     0     0
  SAS-CompFeed          0     1     0     0     0     0     0
  SAS-FoodSuppl         2     0     0     0     0     0     0
  TanzaniaChild2        0     0     0     0     0     1     0
  TDC                   0     0     0     0     0     0     0
  VITAMIN-A             0     0     0     0     0     0     0
  ZVITAMBO              1     0     0     0     0     0     0
> 
> #Convert birth Zscore to absolute units
> table(d$studyid, is.na(d$birthlen))
                   
                    FALSE  TRUE
  Burkina Faso Zn       0  7640
  CMC-V-BCS-2002      103   270
  CMIN Bangladesh93     0   280
  CMIN Brazil89         0   119
  CMIN GB94             0   885
  CMIN Peru89           0   210
  CMIN Peru95           0   224
  CONTENT               0   288
  EE                    0   380
  GMS-Nepal             0   698
  Guatemala BSC         0   315
  iLiNS-DOSE            0  1932
  iLiNS-DYAD-M          0  1244
  iLiNS-Zinc            0  3266
  IRC                 391    19
  JiVitA-3          21017  7288
  JiVitA-4           4483   966
  Keneba             1550  1404
  LCNI-5                0   840
  MAL-ED               54  1814
  NIH-Birth             0   629
  NIH-Crypto          758     0
  PROBIT            17046     0
  PROVIDE             700     0
  ResPak                0   561
  SAS-CompFeed       1520    15
  SAS-FoodSuppl         0   418
  TanzaniaChild2        0  2400
  TDC                  21   139
  VITAMIN-A             0  4000
  ZVITAMBO          13955   155
> table(d$studyid, is.na(d$birthwt))
                   
                    FALSE  TRUE
  Burkina Faso Zn       0  7640
  CMC-V-BCS-2002      365     8
  CMIN Bangladesh93     0   280
  CMIN Brazil89         0   119
  CMIN GB94             0   885
  CMIN Peru89           0   210
  CMIN Peru95           0   224
  CONTENT               0   288
  EE                  379     1
  GMS-Nepal             0   698
  Guatemala BSC         0   315
  iLiNS-DOSE            0  1932
  iLiNS-DYAD-M       1056   188
  iLiNS-Zinc            0  3266
  IRC                 404     6
  JiVitA-3          21422  6883
  JiVitA-4           4509   940
  Keneba                0  2954
  LCNI-5                0   840
  MAL-ED             1697   171
  NIH-Birth             0   629
  NIH-Crypto          758     0
  PROBIT            17046     0
  PROVIDE             700     0
  ResPak                0   561
  SAS-CompFeed       1525    10
  SAS-FoodSuppl         0   418
  TanzaniaChild2     2375    25
  TDC                 151     9
  VITAMIN-A             0  4000
  ZVITAMBO          14064    46
> 
> #sex must be "Male" or "Female" for growthstandards package
> table(d$sex)

         Female    Male Unknown 
    356   48670   50960      11 
> d$sex[!(d$sex %in% c("Male","Female"))] <- NA
> table(is.na(d$sex))

FALSE  TRUE 
99630   367 
> #Drop children with missing sex
> d <- d %>% filter(!is.na(sex))
> 
> #Use agedays-1 as function codes birth age=0
> d$birthlen2 <- who_zscore2value(d$birthmeas_age-1, d$birthLAZ, y_var = "lenhtcm" , x_var = "agedays", sex = d$sex)
> d$birthwt2 <- who_zscore2wtkg(d$birthmeas_age-1, d$birthWAZ, sex = d$sex) * 1000
> d$birthlen2[!is.finite(d$birthlen2)] <- NA
> d$birthwt2[!is.finite(d$birthwt2)] <- NA
> 
> 
> 
> #Check if children without a recorded birthweight or birthlength have WAZ or HAZ in the first 7 days of life
> #and add into birthweight variable
> 
> summary(d$birthlen)
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA's 
  21.80   46.60   48.80   48.79   51.00   68.00   38038 
> summary(d$birthlen2)
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA's 
   9.99   46.46   48.40   48.51   50.40   65.01   42197 
> summary(d$birthwt)
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA's 
    440    2560    2940    2956    3323    7000   33186 
> summary(d$birthwt2)
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA's 
  128.4  2530.1  2898.4  2906.5  3278.4  5714.1   34659 
> 
> table(is.na(d$birthlen), is.na(d$birthlen2))
       
        FALSE  TRUE
  FALSE 55021  6571
  TRUE   2412 35626
> table(is.na(d$birthwt), is.na(d$birthwt2))
       
        FALSE  TRUE
  FALSE 60335  6109
  TRUE   4636 28550
> 
> d$birthlen[is.na(d$birthlen)] <- d$birthlen2[is.na(d$birthlen)]
> d$birthwt[is.na(d$birthwt)] <- d$birthwt2[is.na(d$birthwt)]
> 
> 
> table(d$studyid, is.na(d$birthlen))
                   
                    FALSE  TRUE
  Burkina Faso Zn       0  7640
  CMC-V-BCS-2002      104   269
  CMIN Bangladesh93    13   267
  CMIN Brazil89       115     4
  CMIN GB94             6   879
  CMIN Peru89           5   205
  CMIN Peru95          10   214
  CONTENT               2   213
  EE                    0   380
  GMS-Nepal           140   558
  Guatemala BSC         0   315
  iLiNS-DOSE            0  1932
  iLiNS-DYAD-M          1  1237
  iLiNS-Zinc            0  3266
  IRC                 391    19
  JiVitA-3          22487  5813
  JiVitA-4           4483   966
  Keneba             1552  1402
  LCNI-5                0   840
  MAL-ED               54  1814
  NIH-Birth           604    25
  NIH-Crypto          758     0
  PROBIT            17046     0
  PROVIDE             700     0
  ResPak               42   242
  SAS-CompFeed       1520    15
  SAS-FoodSuppl         0   418
  TanzaniaChild2        0  2400
  TDC                  22   138
  VITAMIN-A             0  4000
  ZVITAMBO          13949   155
> table(d$studyid, is.na(d$birthwt))
                   
                    FALSE  TRUE
  Burkina Faso Zn       0  7640
  CMC-V-BCS-2002      365     8
  CMIN Bangladesh93    14   266
  CMIN Brazil89       115     4
  CMIN GB94             6   879
  CMIN Peru89           5   205
  CMIN Peru95          10   214
  CONTENT               2   213
  EE                  379     1
  GMS-Nepal           140   558
  Guatemala BSC         0   315
  iLiNS-DOSE            0  1932
  iLiNS-DYAD-M       1121   117
  iLiNS-Zinc            0  3266
  IRC                 404     6
  JiVitA-3          22914  5386
  JiVitA-4           4509   940
  Keneba             2118   836
  LCNI-5                0   840
  MAL-ED             1714   154
  NIH-Birth           604    25
  NIH-Crypto          758     0
  PROBIT            17046     0
  PROVIDE             700     0
  ResPak               42   242
  SAS-CompFeed       1525    10
  SAS-FoodSuppl         0   418
  TanzaniaChild2     2375    25
  TDC                 151     9
  VITAMIN-A             5  3995
  ZVITAMBO          14058    46
> 
> #fix 8 observations in CMC cohort with missing birthweight that still have missingess code (9998) rather than NA
> table(df$birthwt==9998)

FALSE 
32482 
> df$birthwt[df$birthwt==9998] <- NA
> #--------------------------------------------------------------------------
> # parental characteristics
> #--------------------------------------------------------------------------
> 
> #single mom
> table(d$studyid[!is.na(d$single)], d$single[!is.na(d$single)])
                
                     0     1
  Guatemala BSC    252    30
  iLiNS-DOSE      1204   674
  iLiNS-DYAD-M    1004   234
  JiVitA-4        5422     8
  MAL-ED          1647   219
  PROBIT         16351   695
  TanzaniaChild2  2155   224
  ZVITAMBO       13152   893
> 
> 
> #Merge in post-birth weight measures for jivita-3 and sas-compfeed
> mat_weight <- readRDS(paste0(ghapdata_dir,"covariate creation intermediate datasets/derived covariate datasets/maternal_weight_dataset.RDS"))
> #Strip grant identifiers from study id's
> mat_weight$studyid<- gsub("^k.*?-" , "", mat_weight$studyid)
> 
> head(mat_weight)
# A tibble: 6 x 3
  subjid mwtkg studyid 
   <dbl> <dbl> <chr>   
1      1  33.8 JiVitA-3
2      2  49.7 JiVitA-3
3      3  47.2 JiVitA-3
4      4  35.2 JiVitA-3
5      5  44   JiVitA-3
6      6  38.5 JiVitA-3
> mat_weight <- mat_weight %>% rename(post_birth_weight=mwtkg)
> mat_weight$subjid <- as.character(mat_weight$subjid)
> 
> d <- left_join(d, mat_weight, by = c("studyid", "subjid"))
> summary(mat_weight$post_birth_weight)
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA's 
  26.80   40.40   44.00   44.85   48.30   88.80     537 
> summary(d$post_birth_weight)
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA's 
   26.8    40.7    44.4    45.2    48.8    81.2   80948 
> d$mwtkg[!is.na(d$post_birth_weight)] <- d$post_birth_weight[!is.na(d$post_birth_weight)]
> 
> #Set BMI to missing for these studies, then recalculate below
> d$mbmi[!is.na(d$post_birth_weight)] <- NA
> d <- d %>% subset(., select = -c(post_birth_weight))
> 
> #Calculate bmi from height and weight, and vice versa, for when only 2 of 3 are measured
> #bmi
> flag <- is.na(d$mbmi) & !is.na(d$mhtcm) & !is.na(d$mwtkg)
> d$mbmi[flag] <- d$mwtkg[flag] / (d$mhtcm[flag] / 100)^2
> 
> #weight
> flag <- is.na(d$mwtkg) & !is.na(d$mhtcm) & !is.na(d$mbmi)
> d$mwtkg[flag] <- d$mbmi[flag] * (d$mhtcm[flag] / 100)^2
> 
> #height
> flag <- is.na(d$mhtcm) & !is.na(d$mwtkg) & !is.na(d$mbmi)
> d$mhtcm[flag] <- sqrt(d$mwtkg[flag] / d$mbmi[flag]) * 100
> 
> summary(d$mbmi)
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA's 
  11.56   18.93   20.92   21.60   23.44  892.33   27823 
> summary(d$mwtkg)
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA's 
  26.60   43.80   50.60   52.83   59.50  168.00   25563 
> summary(d$mhtcm)
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA's 
   41.0   150.0   155.5   155.9   162.0   199.0   24438 
> 
> 
> table(d$studyid, !is.na(d$mbmi))
                   
                    FALSE  TRUE
  Burkina Faso Zn    1696  5944
  CMC-V-BCS-2002      373     0
  CMIN Bangladesh93   280     0
  CMIN Brazil89       119     0
  CMIN GB94           885     0
  CMIN Peru89         210     0
  CMIN Peru95         224     0
  CONTENT             215     0
  EE                  380     0
  GMS-Nepal           698     0
  Guatemala BSC       315     0
  iLiNS-DOSE           11  1921
  iLiNS-DYAD-M         11  1227
  iLiNS-Zinc           49  3217
  IRC                 410     0
  JiVitA-3            135 28165
  JiVitA-4           5449     0
  Keneba             2954     0
  LCNI-5                3   837
  MAL-ED               97  1771
  NIH-Birth             0   629
  NIH-Crypto            3   755
  PROBIT             3318 13728
  PROVIDE              31   669
  ResPak              284     0
  SAS-CompFeed        760  8781
  SAS-FoodSuppl       418     0
  TanzaniaChild2       51  2349
  TDC                 160     0
  VITAMIN-A          4000     0
  ZVITAMBO           4284  9820
> 
> #--------------------------------------------------------------------------
> # house characteristics
> #--------------------------------------------------------------------------
> 
> #set to missing any observations of 0 rooms
> d$nrooms[d$nrooms==0] <- NA
> 
> #check the number of children < 5 and set to missing if 0
> table(d$nchldlt5)

    0     1     2     3     4     5     6     7     8     9    10    11 
21055 13061  3287   815   297    87    23     7     1     3     1     1 
> table(d$studyid[!is.na(d$nchldlt5)], d$nchldlt5[!is.na(d$nchldlt5)])
                
                     0     1     2     3     4     5     6     7     8     9
  iLiNS-DOSE         3   845   817   119    24     5     2     0     0     0
  iLiNS-DYAD-M      66   174    42     7     4     0     1     0     0     0
  iLiNS-Zinc         0  1073  1272   525   231    68    15     4     1     0
  IRC               89   119   100    62    22    12     4     2     0     0
  JiVitA-3       18200  9402   617    42     4     1     0     0     0     0
  LCNI-5             4   391   358    51     9     1     0     1     0     0
  NIH-Crypto       541   211     6     0     0     0     0     0     0     0
  PROVIDE          512   176    12     0     0     0     0     0     0     0
  TanzaniaChild2  1640   670    63     9     3     0     1     0     0     3
                
                    10    11
  iLiNS-DOSE         0     0
  iLiNS-DYAD-M       1     0
  iLiNS-Zinc         0     0
  IRC                0     0
  JiVitA-3           0     0
  LCNI-5             0     1
  NIH-Crypto         0     0
  PROVIDE            0     0
  TanzaniaChild2     0     0
> 
> #Need to shift full distribution by 1 in studies with 0 marked- 
> #  inconsistent marking of subject in the count across studies
> #  Some count number of other children, some number of total children
> d$nchldlt5[d$studyid=="LCNI-5" & d$nchldlt5==0] <- NA #LCNI has 4 children marked as 0 -drop as
> d$nchldlt5[d$studyid=="iLiNS-DOSE" & d$nchldlt5==0] <- NA #ilins-DOSE has 3 children marked as 0 -drop as
> d$nchldlt5[d$studyid=="IRC"] <- d$nchldlt5[d$studyid=="IRC"] + 1
> d$nchldlt5[d$studyid=="PROVIDE"] <- d$nchldlt5[d$studyid=="PROVIDE"] + 1
> d$nchldlt5[d$studyid=="NIH-Crypto"] <- d$nchldlt5[d$studyid=="NIH-Crypto"] + 1
> d$nchldlt5[d$studyid=="TanzaniaChild2"] <- d$nchldlt5[d$studyid=="TanzaniaChild2"] + 1
> d$nchldlt5[d$studyid=="iLiNS-DYAD-M"] <- d$nchldlt5[d$studyid=="iLiNS-DYAD-M"] + 1
> d$nchldlt5[d$studyid=="JiVitA-3"] <- d$nchldlt5[d$studyid=="JiVitA-3"] + 1
> 
> 
> 
> 
> #--------------------------------------------------------
> # create id variable for unit of independent observation
> # (At level of child for most studies, but some trials are cluster-randomized)
> #--------------------------------------------------------
> 
> d$id <- NA
> d$id[d$studyid %in% c("iLiNS-Zinc",
+                       "JiVitA-3",    
+                       "JiVitA-4",
+                       "PROBIT",
+                       "SAS-CompFeed")] <-d$clustid[d$studyid %in% c("iLiNS-Zinc",
+                                                                     "JiVitA-3",    
+                                                                     "JiVitA-4",
+                                                                     "PROBIT",
+                                                                     "SAS-CompFeed")]
> d$id[!(d$studyid %in% c("iLiNS-Zinc",
+                         "JiVitA-3",    
+                         "JiVitA-4",
+                         "PROBIT",
+                         "SAS-CompFeed"))] <-d$subjid[!(d$studyid %in% c("iLiNS-Zinc",
+                                                                         "JiVitA-3",    
+                                                                         "JiVitA-4",
+                                                                         "PROBIT",
+                                                                         "SAS-CompFeed"))]
> 
> #use siteid from PROBIT
> d$id[d$studyid %in% c("PROBIT")] <-d$siteid[d$studyid %in% c("PROBIT")]
> 
> table(is.na(d$id))

 FALSE 
107636 
> 
> 
> #--------------------------------------------------------
> # Classify intervention arms (used in initially-planned analysis)
> # Of intervention effects that was scrapped, but also as adjustment variables
> #--------------------------------------------------------
> 
> arms <- d %>% filter(arm!="") %>% group_by(studyid) %>% do(levels = unique(.$arm))
> arms
# A tibble: 15 x 2
# Rowwise: 
   studyid         levels   
   <chr>           <list>   
 1 Burkina Faso Zn <chr [4]>
 2 Guatemala BSC   <chr [4]>
 3 iLiNS-DOSE      <chr [6]>
 4 iLiNS-DYAD-M    <chr [3]>
 5 iLiNS-Zinc      <chr [5]>
 6 JiVitA-3        <chr [2]>
 7 JiVitA-4        <chr [5]>
 8 LCNI-5          <chr [4]>
 9 PROBIT          <chr [2]>
10 PROVIDE         <chr [4]>
11 SAS-CompFeed    <chr [2]>
12 SAS-FoodSuppl   <chr [4]>
13 TanzaniaChild2  <chr [4]>
14 VITAMIN-A       <chr [2]>
15 ZVITAMBO        <chr [4]>
> 
> 
> d$tr <- NA
> 
> d$tr[d$studyid=="Serrinha-VitA" & d$arm=="Placebo"] <- "Control"
> d$tr[d$studyid=="Serrinha-VitA" & d$arm=="Vitamin A"] <- "VitA"
> 
> d$tr[(d$studyid=="WASH-Bangladesh" | d$studyid=="WASH-Kenya")] <- "Other"
> d$tr[(d$studyid=="WASH-Bangladesh" | d$studyid=="WASH-Kenya") & (d$arm=="Control" | d$arm=="Passive Control")] <- "Control"
> d$tr[(d$studyid=="WASH-Bangladesh" | d$studyid=="WASH-Kenya") & (d$arm=="Nutrition" | d$arm=="Nutrition + WSH")] <- "LNS"
> 
> d$tr[d$studyid=="AgaKhanUniv" & d$arm=="Control"] <- "Control"
> d$tr[d$studyid=="AgaKhanUniv" & d$arm=="Intervention"] <- "Maternal"
> 
> d$tr[d$studyid=="EU" & d$arm=="Placebo"] <- "Control"
> d$tr[d$studyid=="EU" & d$arm=="Zinc"] <- "Zinc"
> 
> d$tr[d$studyid=="VITAMIN-A" & d$arm=="Control"] <- "Control"
> d$tr[d$studyid=="VITAMIN-A" & d$arm=="Vitamin A"] <- "VitA"
> 
> d$tr[d$studyid=="Vitamin-B12" ] <- "Other"
> d$tr[d$studyid=="Vitamin-B12" & d$arm=="Placebo"] <- "Control"
> 
> d$tr[d$studyid=="ZnMort" & d$arm=="IFA"] <- "Control"
> d$tr[d$studyid=="ZnMort" & d$arm=="Zinc+IFA"] <- "Zinc"
> 
> d$tr[d$studyid=="SAS-CompFeed" & d$arm=="Control"] <- "Control"
> d$tr[d$studyid=="SAS-CompFeed" & (d$arm=="Intervention"|d$arm=="")] <- "Other"
> 
> d$tr[d$studyid=="SAS-FoodSuppl" ] <- "Other"
> d$tr[d$studyid=="SAS-FoodSuppl" & d$arm=="No intervention"] <- "Control"
> 
> d$tr[d$studyid=="PROVIDE" ] <- "Other"
> d$tr[d$studyid=="PROVIDE" & d$arm=="No Rotarix + No IPV (175)"] <- "Control"
> 
> d$tr[d$studyid=="TanzaniaChild2" & d$arm=="Control"] <- "Control"
> d$tr[d$studyid=="TanzaniaChild2" & d$arm=="Multivitamin Alone"] <- "Other"
> d$tr[d$studyid=="TanzaniaChild2" & (d$arm=="Zinc Alone" | d$arm=="Zinc + Multivitamin")] <- "Zinc"
> 
> d$tr[d$studyid=="Burkina Faso Zn" ] <- "Zinc"
> d$tr[d$studyid=="Burkina Faso Zn" & d$arm=="Control (no Zinc)"] <- "Control"
> 
> d$tr[d$studyid=="Guatemala BSC" ] <- "Other"
> d$tr[d$studyid=="Guatemala BSC" & (d$arm=="WPC"|d$arm=="MNT + WPC")] <- "Control"
> 
> d$tr[d$studyid=="iLiNS-Zinc" ] <- "LNS"
> d$tr[d$studyid=="iLiNS-Zinc" & d$arm=="e.Control"] <- "Control"
> 
> #Create secondary dataset for Zinc+LNS vs LNS contrast
> iLiNS_Zinc_df <- d[d$studyid=="iLiNS-Zinc" & d$arm!="e.Control", ]
> iLiNS_Zinc_df$tr <- "Zinc"
> iLiNS_Zinc_df$tr[iLiNS_Zinc_df$arm=="a.LNS-Zn0"] <- "Control"
> iLiNS_Zinc_df$studyid <- "iLiNS-Zinc_ZvLNS"
> 
> d$tr[d$studyid=="PROBIT" ] <- "Maternal"
> d$tr[d$studyid=="PROBIT" & d$arm=="Control group"] <- "Control"
> 
> d$tr[d$studyid=="ZVITAMBO" ] <- "VitA"
> d$tr[d$studyid=="ZVITAMBO" & d$arm=="Placebo nippled + Placebo Oval"] <- "Control"
> 
> 
> d$tr[d$studyid=="COHORTS" & d$arm=="Control"] <- "Control"
> d$tr[d$studyid=="COHORTS" & d$arm=="Intervention"] <- "Other"
> 
> d$tr[d$studyid=="iLiNS-DOSE" & d$arm=="Control"] <- "Control"
> d$tr[d$studyid=="iLiNS-DOSE" & d$arm!="Control"] <- "LNS"
> 
> d$tr[d$studyid=="iLiNS-DYAD-M" & d$arm=="Iron and folic acid supplementation"] <- "Control"
> d$tr[d$studyid=="iLiNS-DYAD-M" & d$arm!="Iron and folic acid supplementation"] <- "Maternal"
> 
> 
> iLiNS_DYADM_df <- d[d$studyid=="iLiNS-DYAD-M" & d$arm!="Multiple micronutrient supplementation", ]
> iLiNS_DYADM_df$tr <- "Control"
> iLiNS_DYADM_df$tr[iLiNS_DYADM_df$arm!="Iron and folic acid supplementation"] <- "LNS"
> iLiNS_DYADM_df$studyid <- "iLiNS_DYADM_LNS"
> 
> d$tr[d$studyid=="LCNI-5"& d$arm=="Standard(Control)"] <- "Control"
> d$tr[d$studyid=="LCNI-5"& (d$arm=="Milk FS"|d$arm=="Soy FS")] <- "LNS"
> d$tr[d$studyid=="LCNI-5"& d$arm=="Likuni Phala"] <- "Other"
> 
> d$tr[d$studyid=="JiVitA-3" & d$arm=="Iron Folic Acid"] <- "Control"
> d$tr[d$studyid=="JiVitA-3" & d$arm=="Multiple Micronutrients"] <- "Maternal"
> 
> d$tr[d$studyid=="JiVitA-4"] <- "Other"
> d$tr[d$studyid=="JiVitA-4" & d$arm=="CFC"] <- "Control"
> d$tr[d$studyid=="JiVitA-4" & d$arm=="Plumpy Doz"] <- "LNS"
> 
> 
> 
> #--------------------------------------------------------
> # Drop risk factors without enough studies or unneeded/temporary variables 
> #--------------------------------------------------------
> 
> colnames(d)
  [1] "studyid"        "subjid"         "sex"            "month"         
  [5] "wtkg"           "htcm"           "lencm"          "hcircm"        
  [9] "muaccm"         "muaz"           "siteid"         "ctrycd"        
 [13] "country"        "region"         "citytown"       "latitude"      
 [17] "longitud"       "clustid"        "arm"            "tr"            
 [21] "gagebrth"       "dead"           "agedth"         "causedth"      
 [25] "brthyr"         "brthweek"       "brthmon"        "parity"        
 [29] "brthordr"       "birthwt"        "birthlen"       "vagbrth"       
 [33] "hdlvry"         "mage"           "mhtcm"          "mwtkg"         
 [37] "mbmi"           "meducyrs"       "single"         "fage"          
 [41] "fhtcm"          "feducyrs"       "trth2o"         "cleanck"       
 [45] "impfloor"       "nrooms"         "nhh"            "nchldlt5"      
 [49] "ses"            "earlybf"        "hfoodsec"       "sexn"          
 [53] "feedingn"       "feeding"        "delivery"       "regctry"       
 [57] "regctyp"        "elevatn"        "bmi"            "baz"           
 [61] "gravida"        "nabt"           "nstlbrth"       "nlchild"       
 [65] "dlvlocn"        "dlvloc"         "aborthx"        "nadult"        
 [69] "nchld"          "car"            "clthcab"        "cookfuel"      
 [73] "cookplac"       "famtyp"         "fan"            "floor"         
 [77] "llphone"        "mobile"         "ownhome"        "roof"          
 [81] "taperec"        "tv"             "wall"           "h2otrtp"       
 [85] "sumep"          "sumdiar"        "sumdays"        "pctdiar"       
 [89] "flag"           "med_start"      "measurefreq"    "anywast06"     
 [93] "pers_wast"      "enstunt"        "enwast"         "birthLAZ"      
 [97] "birthWAZ"       "birthmeas_age"  "hhwealth_quart" "birthlen2"     
[101] "birthwt2"       "id"            
> 
> d <- subset(d, select = c(studyid,       subjid,        sex,           month,  country,       region,         arm,           tr,            gagebrth,     
+                           brthmon,       parity,       
+                           birthwt,       birthlen,      vagbrth,       hdlvry,        mage,          mhtcm,        
+                           mwtkg,         mbmi,          meducyrs,      single,        fage,          fhtcm,         feducyrs,     
+                           trth2o,        cleanck,       impfloor,      nrooms,        nhh,           nchldlt5,      ses,          
+                           earlybf,       hfoodsec,   measurefreq,   anywast06,    
+                           pers_wast,     enstunt,       enwast,     hhwealth_quart,      id))
> 
> 
> #--------------------------------------------------------
> # Convert continious variables to quartiled categorical 
> # variables for use as primary exposures
> #--------------------------------------------------------
> 
> 
> 
> #quantiling functions
> quantile_rf <- function(data, A, labs=NULL, Acuts=NULL, units=NULL){
+   A<-as.numeric(A)
+   if(sum(is.na(A))!=length(A)){
+     if(is.null(Acuts)){
+       Acuts=c(0, as.numeric(quantile(A, probs = c(.25,.5,.75), na.rm=T)), max(A, na.rm=T))
+     }
+     
+     if(length(Acuts)==3){
+       Alevels=c(paste0("<",round(Acuts[2],2)), 
+                 paste0(">=",round(Acuts[2],2))) 
+     }    
+     if(length(Acuts)==4){
+       Alevels=c(paste0("<",round(Acuts[2],2)), 
+                 paste0("[",round(Acuts[2],2),"-",round(Acuts[3],2),")"),
+                 paste0(">=",round(Acuts[3],2))) 
+     }
+     if(length(Acuts)==5){
+       Alevels=c(paste0("<",round(Acuts[2],2)), 
+                 paste0("[",round(Acuts[2],2),"-",round(Acuts[3],2),")"),
+                 paste0("[",round(Acuts[3],2),"-",round(Acuts[4],2),")"), 
+                 paste0(">=",round(Acuts[4],2))) 
+     }
+     if(length(Acuts)==6){
+       Alevels=c(paste0("<",round(Acuts[2],2)), 
+                 paste0("[",round(Acuts[2],2),"-",round(Acuts[3],2),")"),
+                 paste0("[",round(Acuts[3],2),"-",round(Acuts[4],2),")"),
+                 paste0("[",round(Acuts[4],2),"-",round(Acuts[5],2),")"), 
+                 paste0(">=",round(Acuts[5],2))) 
+     }    
+     
+     
+     if(!is.null(labs)){
+       Alevels=labs
+     }
+     if(!is.null(units)){
+       Alevels=paste0(Alevels, " ", units)
+     }
+     
+     if(length(unique(Acuts))==length((Acuts))){
+       A <- cut(A, include.lowest = T, right = FALSE, breaks=Acuts,labels=Alevels)
+     }else{
+       A <- cut(A, include.lowest = T, right = FALSE, breaks=4,labels=c("Q1","Q2","Q3","Q4","Q5")[1:(length(Acuts)-1)])
+     }
+     A <- factor(A)
+     
+     printdf <- data.frame(id=paste0(data$studyid," ", data$country), A)
+     printdf <- printdf %>% filter(!is.na(A))
+     printdf <- droplevels(printdf) 
+     print(table(printdf$id, printdf$A))
+     
+     print(table( printdf$A))
+     return(A)
+   }
+ }
> 
> 
> #A-priori categorical levels
> #gestational age at birth
> #<37 weeks = preterm
> #37-38 weeks = early term
> #39-40 weeks = full term (baseline)
> #>=41 weeks = late/post term
> 
> #maternal BMI
> #<18.5 = underweight
> #>=18.5 and <25 = normal weight (baseline)
> #>=25 and <30 = overweight
> #>=30 = obese
> 
> 
> #Save continious variables as seperate variables to use as adjustment covariates
> d$W_gagebrth <- d$gagebrth
> d$W_birthwt <- d$birthwt
> d$W_birthlen <- d$birthlen
> d$W_mage <- d$mage
> d$W_mhtcm <- d$mhtcm
> d$W_mwtkg <- d$mwtkg
> d$W_mbmi <- d$mbmi
> d$W_fage <- d$fage
> d$W_fhtcm <- d$fhtcm
> d$W_meducyrs <- d$meducyrs
> d$W_feducyrs <- d$feducyrs
> 
> d$W_nrooms <- d$nrooms
> d$W_nhh <- d$nhh
> d$W_nchldlt5 <- d$nchldlt5
> d$W_parity <- d$parity
> 
> 
> 
> 
> #Overall a-priori quantiles
> d$gagebrth <- quantile_rf(d, d$W_gagebrth, Acuts=c(0,260,274,max(d$W_gagebrth, na.rm=T)), labs=c("Preterm", "Early term", "Full or late term"))
                                             
                                              Preterm Early term
  CMC-V-BCS-2002 INDIA                             52         84
  iLiNS-DYAD-M MALAWI                             105        324
  IRC INDIA                                        42         98
  JiVitA-3 BANGLADESH                            5811       7289
  Keneba GAMBIA                                   257        609
  NIH-Crypto BANGLADESH                           265        325
  PROBIT BELARUS                                  598       7749
  TanzaniaChild2 TANZANIA, UNITED REPUBLIC OF     350        515
                                             
                                              Full or late term
  CMC-V-BCS-2002 INDIA                                      215
  iLiNS-DYAD-M MALAWI                                       809
  IRC INDIA                                                 250
  JiVitA-3 BANGLADESH                                     13683
  Keneba GAMBIA                                             847
  NIH-Crypto BANGLADESH                                     168
  PROBIT BELARUS                                           8699
  TanzaniaChild2 TANZANIA, UNITED REPUBLIC OF              1393

          Preterm        Early term Full or late term 
             7480             16993             26064 
> d$birthwt <- quantile_rf(d, d$W_birthwt, Acuts=c(0,2500,max(d$W_birthwt, na.rm=T)), labs=c("Low birthweight", "Normal or high birthweight"))
                                             
                                              Low birthweight
  CMC-V-BCS-2002 INDIA                                     43
  CMIN Bangladesh93 BANGLADESH                              8
  CMIN Brazil89 BRAZIL                                      7
  CMIN GB94 GUINEA-BISSAU                                   0
  CMIN Peru89 PERU                                          0
  CMIN Peru95 PERU                                          0
  CONTENT PERU                                              0
  EE PAKISTAN                                             134
  GMS-Nepal NEPAL                                          44
  iLiNS-DYAD-M MALAWI                                     160
  IRC INDIA                                                69
  JiVitA-3 BANGLADESH                                    9924
  JiVitA-4 BANGLADESH                                    1179
  Keneba GAMBIA                                           313
  MAL-ED BANGLADESH                                        55
  MAL-ED BRAZIL                                            12
  MAL-ED INDIA                                             40
  MAL-ED NEPAL                                             21
  MAL-ED PERU                                              20
  MAL-ED SOUTH AFRICA                                      24
  MAL-ED TANZANIA, UNITED REPUBLIC OF                       7
  NIH-Birth BANGLADESH                                    195
  NIH-Crypto BANGLADESH                                   177
  PROBIT BELARUS                                            0
  PROVIDE BANGLADESH                                      168
  ResPak PAKISTAN                                           8
  SAS-CompFeed INDIA                                     2324
  TanzaniaChild2 TANZANIA, UNITED REPUBLIC OF              82
  TDC INDIA                                                18
  VITAMIN-A INDIA                                           1
  ZVITAMBO ZIMBABWE                                      1938
                                             
                                              Normal or high birthweight
  CMC-V-BCS-2002 INDIA                                               322
  CMIN Bangladesh93 BANGLADESH                                         6
  CMIN Brazil89 BRAZIL                                               108
  CMIN GB94 GUINEA-BISSAU                                              6
  CMIN Peru89 PERU                                                     5
  CMIN Peru95 PERU                                                    10
  CONTENT PERU                                                         2
  EE PAKISTAN                                                        245
  GMS-Nepal NEPAL                                                     96
  iLiNS-DYAD-M MALAWI                                                961
  IRC INDIA                                                          335
  JiVitA-3 BANGLADESH                                              12990
  JiVitA-4 BANGLADESH                                               3330
  Keneba GAMBIA                                                     1805
  MAL-ED BANGLADESH                                                  203
  MAL-ED BRAZIL                                                      221
  MAL-ED INDIA                                                       205
  MAL-ED NEPAL                                                       212
  MAL-ED PERU                                                        279
  MAL-ED SOUTH AFRICA                                                290
  MAL-ED TANZANIA, UNITED REPUBLIC OF                                125
  NIH-Birth BANGLADESH                                               409
  NIH-Crypto BANGLADESH                                              581
  PROBIT BELARUS                                                   17046
  PROVIDE BANGLADESH                                                 532
  ResPak PAKISTAN                                                     34
  SAS-CompFeed INDIA                                                7159
  TanzaniaChild2 TANZANIA, UNITED REPUBLIC OF                       2293
  TDC INDIA                                                          133
  VITAMIN-A INDIA                                                      4
  ZVITAMBO ZIMBABWE                                                12120

           Low birthweight Normal or high birthweight 
                     16971                      62067 
> d$birthlen <- quantile_rf(d, d$W_birthlen, Acuts=c(0,48, 50, max(d$W_birthlen, na.rm=T)), units="cm")
                              
                               <48 cm [48-50) cm >=50 cm
  CMC-V-BCS-2002 INDIA             49         40      15
  CMIN Bangladesh93 BANGLADESH     11          0       2
  CMIN Brazil89 BRAZIL             25         37      53
  CMIN GB94 GUINEA-BISSAU           2          3       1
  CMIN Peru89 PERU                  0          2       3
  CMIN Peru95 PERU                  0          1       9
  CONTENT PERU                      1          0       1
  GMS-Nepal NEPAL                  88         33      19
  iLiNS-DYAD-M MALAWI               1          0       0
  IRC INDIA                       111        138     142
  JiVitA-3 BANGLADESH           16203       5066    1218
  JiVitA-4 BANGLADESH            2174       1077    1232
  Keneba GAMBIA                   293        495     764
  MAL-ED BANGLADESH                38         10       6
  NIH-Birth BANGLADESH            252        230     122
  NIH-Crypto BANGLADESH           292        298     168
  PROBIT BELARUS                  192       1410   15444
  PROVIDE BANGLADESH              248        283     169
  ResPak PAKISTAN                  19         13      10
  SAS-CompFeed INDIA             5050       3004    1406
  TDC INDIA                         8          8       6
  ZVITAMBO ZIMBABWE              4482       5341    4126

    <48 cm [48-50) cm    >=50 cm 
     29539      17489      24916 
> 
> # Fix Ages in Burkino Faso Zinc so they are categorized correctly by the function, which are based on these categories:
> #Categories: <20 years old; 20-29 years old; 30-39 years old; 40-49 years old; 50+ years old
> d$W_mage[d$studyid=="Burkina Faso Zn" & d$W_mage==20] <- 18
> d$mage <- quantile_rf(d, d$W_mage, Acuts=c(0,20,30,max(d$W_mage, na.rm=T)))
                                             
                                                <20 [20-30)  >=30
  Burkina Faso Zn BURKINA FASO                  848    3069  2328
  CMC-V-BCS-2002 INDIA                           34     296    43
  EE PAKISTAN                                     1     162   214
  GMS-Nepal NEPAL                               149     447   102
  Guatemala BSC GUATEMALA                        47     175    59
  iLiNS-DOSE MALAWI                             301    1080   469
  iLiNS-DYAD-M MALAWI                           293     687   258
  iLiNS-Zinc BURKINA FASO                       403    1743  1033
  IRC INDIA                                      37     344    29
  JiVitA-3 BANGLADESH                         12765   13101  2422
  Keneba GAMBIA                                 399    1455  1042
  LCNI-5 MALAWI                                 108     364   198
  MAL-ED BANGLADESH                              37     182    46
  MAL-ED BRAZIL                                  43     139    51
  MAL-ED INDIA                                   34     194    21
  MAL-ED NEPAL                                    5     189    46
  MAL-ED PERU                                    83     153    67
  MAL-ED SOUTH AFRICA                            48     161   105
  MAL-ED TANZANIA, UNITED REPUBLIC OF            16     140   106
  NIH-Birth BANGLADESH                           73     422   132
  NIH-Crypto BANGLADESH                         136     494   128
  PROBIT BELARUS                               1769   12244  3032
  PROVIDE BANGLADESH                             85     493   122
  SAS-CompFeed INDIA                           1227    7276  1038
  SAS-FoodSuppl INDIA                            36     290    92
  TanzaniaChild2 TANZANIA, UNITED REPUBLIC OF   167    1574   639
  VITAMIN-A INDIA                               254    3210   530
  ZVITAMBO ZIMBABWE                            2245    9461  2358

    <20 [20-30)    >=30 
  21643   59545   16710 
> 
> d$mhtcm <- quantile_rf(d, d$W_mhtcm, Acuts=c(0,151,155,max(d$W_mhtcm, na.rm=T)), units="cm")
                                             
                                              <151 cm [151-155) cm >=155 cm
  Burkina Faso Zn BURKINA FASO                    327          801     5034
  Guatemala BSC GUATEMALA                         143           56       36
  iLiNS-DOSE MALAWI                               398          470     1060
  iLiNS-DYAD-M MALAWI                             210          335      686
  iLiNS-Zinc BURKINA FASO                          91          226     2900
  JiVitA-3 BANGLADESH                           16825         7068     4273
  Keneba GAMBIA                                    94          328     2035
  LCNI-5 MALAWI                                   131          192      514
  MAL-ED BANGLADESH                               163           66       25
  MAL-ED BRAZIL                                    53           39      130
  MAL-ED INDIA                                    115           72       55
  MAL-ED NEPAL                                    133           64       41
  MAL-ED PERU                                     169           61       60
  MAL-ED SOUTH AFRICA                              33           33      204
  MAL-ED TANZANIA, UNITED REPUBLIC OF              51           52      153
  NIH-Birth BANGLADESH                            366          146      117
  NIH-Crypto BANGLADESH                           435          180      140
  PROBIT BELARUS                                  125          398    13211
  PROVIDE BANGLADESH                              373          158      138
  SAS-CompFeed INDIA                             3007         2091     3683
  SAS-FoodSuppl INDIA                             220          111       78
  TanzaniaChild2 TANZANIA, UNITED REPUBLIC OF     360          511     1492
  ZVITAMBO ZIMBABWE                               574         1440     7839

     <151 cm [151-155) cm     >=155 cm 
       24396        14898        43904 
> d$mwtkg <- quantile_rf(d, d$W_mwtkg, Acuts=c(0,52,58,max(d$W_mwtkg, na.rm=T)), units="kg")
                                             
                                              <52 kg [52-58) kg >=58 kg
  Burkina Faso Zn BURKINA FASO                  2344       1926    1674
  iLiNS-DOSE MALAWI                              938        567     419
  iLiNS-DYAD-M MALAWI                            553        382     298
  iLiNS-Zinc BURKINA FASO                       1201       1079     937
  JiVitA-3 BANGLADESH                          25742       1830     694
  LCNI-5 MALAWI                                  504        220     114
  MAL-ED BANGLADESH                              162         44      48
  MAL-ED BRAZIL                                   42         36     143
  MAL-ED INDIA                                   150         50      42
  MAL-ED NEPAL                                    76         82      80
  MAL-ED PERU                                    115         71     104
  MAL-ED SOUTH AFRICA                             30         46     194
  MAL-ED TANZANIA, UNITED REPUBLIC OF             99         59      98
  NIH-Birth BANGLADESH                           453         94      82
  NIH-Crypto BANGLADESH                          406        157     192
  PROBIT BELARUS                                1131       2362   10279
  PROVIDE BANGLADESH                             432        117     120
  SAS-CompFeed INDIA                            7250       1518     723
  TanzaniaChild2 TANZANIA, UNITED REPUBLIC OF    395        483    1478
  ZVITAMBO ZIMBABWE                             2410       2953    5845

    <52 kg [52-58) kg    >=58 kg 
     44433      14076      23564 
> d$mbmi <- quantile_rf(d, d$W_mbmi, Acuts=c(0,18.5,max(d$W_mbmi, na.rm=T)), labs=c("Underweight", "Normal weight"))
                                             
                                              Underweight Normal weight
  Burkina Faso Zn BURKINA FASO                        602          5342
  iLiNS-DOSE MALAWI                                   136          1785
  iLiNS-DYAD-M MALAWI                                  67          1160
  iLiNS-Zinc BURKINA FASO                             454          2763
  JiVitA-3 BANGLADESH                               10775         17390
  LCNI-5 MALAWI                                       145           692
  MAL-ED BANGLADESH                                    32           222
  MAL-ED BRAZIL                                        10           211
  MAL-ED INDIA                                         49           193
  MAL-ED NEPAL                                          0           238
  MAL-ED PERU                                           5           285
  MAL-ED SOUTH AFRICA                                   8           262
  MAL-ED TANZANIA, UNITED REPUBLIC OF                  14           242
  NIH-Birth BANGLADESH                                106           523
  NIH-Crypto BANGLADESH                                68           687
  PROBIT BELARUS                                      523         13205
  PROVIDE BANGLADESH                                  127           542
  SAS-CompFeed INDIA                                 2345          6436
  TanzaniaChild2 TANZANIA, UNITED REPUBLIC OF          38          2311
  ZVITAMBO ZIMBABWE                                   517          9303

  Underweight Normal weight 
        16021         63792 
> d$fage <- quantile_rf(d, d$W_fage, Acuts=c(0,32,38,max(d$W_fage, na.rm=T)))
                                     
                                        <32 [32-38)  >=38
  iLiNS-DOSE MALAWI                     988     341   384
  iLiNS-DYAD-M MALAWI                   702     253   237
  LCNI-5 MALAWI                          56      24    26
  MAL-ED BANGLADESH                      30      52    69
  MAL-ED BRAZIL                          18      31    30
  MAL-ED INDIA                           53      72    36
  MAL-ED NEPAL                           15      47    17
  MAL-ED PERU                            29      29    27
  MAL-ED SOUTH AFRICA                     9      16    65
  MAL-ED TANZANIA, UNITED REPUBLIC OF    15      37    48
  PROBIT BELARUS                      13189    2486   749
  SAS-CompFeed INDIA                   8015    1196   309
  SAS-FoodSuppl INDIA                   289      85    44

    <32 [32-38)    >=38 
  23408    4669    2041 
> d$fhtcm <- quantile_rf(d, d$W_fhtcm, Acuts=c(0,162,167,max(d$W_fhtcm, na.rm=T)), units="cm")
                     
                      <162 cm [162-167) cm >=167 cm
  Keneba GAMBIA           133          557     1258
  PROBIT BELARUS          168          625    11744
  SAS-CompFeed INDIA     1391         1703     2658
  SAS-FoodSuppl INDIA     163          130      106

     <162 cm [162-167) cm     >=167 cm 
        1855         3015        15766 
> 
> 
> 
> 
> #Make education categorizing function that handles the irregular distribution across studies.
> # (As years of education is more country-specific, categorize within studies)
> # Function groups subjects into even categories from irregular distributions of education 
> # (just tertiling leads to sparsity/R errors)
> 
> quantile_rf_edu <- function(d, Avar="meducyrs", to.character=F){
+   dfull <-d
+   
+   print(d$studyid[1])
+   print(d$country[1])
+   
+   A0 <- NULL
+   d <- data.frame(id=1:nrow(dfull), A=as.data.frame(dfull[,Avar])[,1])
+   
+   if(sum(is.na(d$A))!=nrow(d)){
+     
+     Acuts=c(0, as.numeric(quantile(d$A, probs = c(1/3, 2/3), na.rm=T)), max(d$A, na.rm=T))
+     if(length(Acuts)==length(unique(Acuts))){
+       
+       Alevels=c("Low","Medium","High")
+       A1 <- cut(d$A, include.lowest = T, right = T, breaks=Acuts,labels=Alevels)
+       A2 <- cut(d$A, include.lowest = T, right = F, breaks=Acuts,labels=Alevels)
+       rght=F
+       if(min(table(A1)) >= min(table(A2))) rght=T
+       A <- cut(d$A, include.lowest = T, right = rght, breaks=Acuts,labels=Alevels)
+       
+     }else{
+       if(Acuts[2]==Acuts[3] & Acuts[2]!=0){
+         A<-rep(NA, nrow(d))
+         A[d$A < Acuts[2] & !is.na(d$A)] <- "Low"
+         A[d$A == Acuts[2] & !is.na(d$A)] <- "Medium"
+         A[d$A > Acuts[2] & !is.na(d$A)] <- "High"
+         A <- factor(A, levels = c("Low","Medium","High"))
+       }else{
+         
+         if(sum(d$A==0, na.rm=T)>0){
+           A0 <- d[d$A==0,]
+           A0 <- A0[!is.na(A0$A),]
+           A0$A <- "Low"
+         }
+         
+         A <- d[d$A!=0 | is.na(d$A),]
+         Acuts=c(0, as.numeric(quantile(A$A, probs = 0.5, na.rm=T)), max(A$A, na.rm=T))
+         Alevels=c("Medium","High")    
+         A$A <- cut(A$A, include.lowest = T, right = T, breaks=Acuts,labels=Alevels)
+         if(!is.null(A0)){
+           df<-rbind(A,A0)
+         }else{
+           df<-A
+         }
+         
+         df <- df %>% arrange(id)
+         A <- factor(df$A, levels = c("Low","Medium","High"))
+       }
+     }
+     dfull[,Avar] <- A
+     
+   }
+   dfull <-as.data.frame(dfull)
+   if(to.character){
+     dfull[,Avar] <- as.character(dfull[,Avar])
+   }
+   print(class(dfull[,Avar]))
+   return(dfull)
+ }
> 
> d$meducyrs <- as.numeric(as.character(d$meducyrs))
> d <- d %>% group_by(studyid, country) %>%
+   do(quantile_rf_edu(., Avar="meducyrs", to.character=T))
[1] "Burkina Faso Zn"
[1] "BURKINA FASO"
[1] "character"
[1] "CMC-V-BCS-2002"
[1] "INDIA"
[1] "character"
[1] "CMIN Bangladesh93"
[1] "BANGLADESH"
[1] "character"
[1] "CMIN Brazil89"
[1] "BRAZIL"
[1] "character"
[1] "CMIN GB94"
[1] "GUINEA-BISSAU"
[1] "character"
[1] "CMIN Peru89"
[1] "PERU"
[1] "character"
[1] "CMIN Peru95"
[1] "PERU"
[1] "character"
[1] "CONTENT"
[1] "PERU"
[1] "character"
[1] "EE"
[1] "PAKISTAN"
[1] "character"
[1] "GMS-Nepal"
[1] "NEPAL"
[1] "character"
[1] "Guatemala BSC"
[1] "GUATEMALA"
[1] "character"
[1] "iLiNS-DOSE"
[1] "MALAWI"
[1] "character"
[1] "iLiNS-DYAD-M"
[1] "MALAWI"
[1] "character"
[1] "iLiNS-Zinc"
[1] "BURKINA FASO"
[1] "character"
[1] "IRC"
[1] "INDIA"
[1] "character"
[1] "JiVitA-3"
[1] "BANGLADESH"
[1] "character"
[1] "JiVitA-4"
[1] "BANGLADESH"
[1] "character"
[1] "Keneba"
[1] "GAMBIA"
[1] "character"
[1] "LCNI-5"
[1] "MALAWI"
[1] "character"
[1] "MAL-ED"
[1] "BANGLADESH"
[1] "character"
[1] "MAL-ED"
[1] "BRAZIL"
[1] "character"
[1] "MAL-ED"
[1] "INDIA"
[1] "character"
[1] "MAL-ED"
[1] "NEPAL"
[1] "character"
[1] "MAL-ED"
[1] "PERU"
[1] "character"
[1] "MAL-ED"
[1] "SOUTH AFRICA"
[1] "character"
[1] "MAL-ED"
[1] "TANZANIA, UNITED REPUBLIC OF"
[1] "character"
[1] "NIH-Birth"
[1] "BANGLADESH"
[1] "character"
[1] "NIH-Crypto"
[1] "BANGLADESH"
[1] "character"
[1] "PROBIT"
[1] "BELARUS"
[1] "character"
[1] "PROVIDE"
[1] "BANGLADESH"
[1] "character"
[1] "ResPak"
[1] "PAKISTAN"
[1] "character"
[1] "SAS-CompFeed"
[1] "INDIA"
[1] "character"
[1] "SAS-FoodSuppl"
[1] "INDIA"
[1] "character"
[1] "TanzaniaChild2"
[1] "TANZANIA, UNITED REPUBLIC OF"
[1] "character"
[1] "TDC"
[1] "INDIA"
[1] "character"
[1] "VITAMIN-A"
[1] "INDIA"
[1] "character"
[1] "ZVITAMBO"
[1] "ZIMBABWE"
[1] "character"
> #d <- d %>% arrange(feducyrs, studyid, country, subjid)
> d <- d %>% group_by(studyid, country) %>%
+   do(quantile_rf_edu(., Avar="feducyrs", to.character=T))
[1] "Burkina Faso Zn"
[1] "BURKINA FASO"
[1] "character"
[1] "CMC-V-BCS-2002"
[1] "INDIA"
[1] "character"
[1] "CMIN Bangladesh93"
[1] "BANGLADESH"
[1] "character"
[1] "CMIN Brazil89"
[1] "BRAZIL"
[1] "character"
[1] "CMIN GB94"
[1] "GUINEA-BISSAU"
[1] "character"
[1] "CMIN Peru89"
[1] "PERU"
[1] "character"
[1] "CMIN Peru95"
[1] "PERU"
[1] "character"
[1] "CONTENT"
[1] "PERU"
[1] "character"
[1] "EE"
[1] "PAKISTAN"
[1] "character"
[1] "GMS-Nepal"
[1] "NEPAL"
[1] "character"
[1] "Guatemala BSC"
[1] "GUATEMALA"
[1] "character"
[1] "iLiNS-DOSE"
[1] "MALAWI"
[1] "character"
[1] "iLiNS-DYAD-M"
[1] "MALAWI"
[1] "character"
[1] "iLiNS-Zinc"
[1] "BURKINA FASO"
[1] "character"
[1] "IRC"
[1] "INDIA"
[1] "character"
[1] "JiVitA-3"
[1] "BANGLADESH"
[1] "character"
[1] "JiVitA-4"
[1] "BANGLADESH"
[1] "character"
[1] "Keneba"
[1] "GAMBIA"
[1] "character"
[1] "LCNI-5"
[1] "MALAWI"
[1] "character"
[1] "MAL-ED"
[1] "BANGLADESH"
[1] "character"
[1] "MAL-ED"
[1] "BRAZIL"
[1] "character"
[1] "MAL-ED"
[1] "INDIA"
[1] "character"
[1] "MAL-ED"
[1] "NEPAL"
[1] "character"
[1] "MAL-ED"
[1] "PERU"
[1] "character"
[1] "MAL-ED"
[1] "SOUTH AFRICA"
[1] "character"
[1] "MAL-ED"
[1] "TANZANIA, UNITED REPUBLIC OF"
[1] "character"
[1] "NIH-Birth"
[1] "BANGLADESH"
[1] "character"
[1] "NIH-Crypto"
[1] "BANGLADESH"
[1] "character"
[1] "PROBIT"
[1] "BELARUS"
[1] "character"
[1] "PROVIDE"
[1] "BANGLADESH"
[1] "character"
[1] "ResPak"
[1] "PAKISTAN"
[1] "character"
[1] "SAS-CompFeed"
[1] "INDIA"
[1] "character"
[1] "SAS-FoodSuppl"
[1] "INDIA"
[1] "character"
[1] "TanzaniaChild2"
[1] "TANZANIA, UNITED REPUBLIC OF"
[1] "character"
[1] "TDC"
[1] "INDIA"
[1] "character"
[1] "VITAMIN-A"
[1] "INDIA"
[1] "character"
[1] "ZVITAMBO"
[1] "ZIMBABWE"
[1] "character"
> d$meducyrs <- factor(d$meducyrs, levels = c("Low","Medium","High"))
> d$feducyrs <- factor(d$feducyrs, levels = c("Low","Medium","High"))
> 
> table(d$meducyrs)

   Low Medium   High 
 36379  32180  28425 
> table(d$feducyrs)

   Low Medium   High 
 30979  36119  18909 
> 
> table(paste0(d$studyid," ", d$country), d$meducyrs)
                                             
                                                Low Medium  High
  Burkina Faso Zn BURKINA FASO                 4827    873   256
  CMC-V-BCS-2002 INDIA                          106    109   158
  CMIN Bangladesh93 BANGLADESH                    0      0     0
  CMIN Brazil89 BRAZIL                            0      0     0
  CMIN GB94 GUINEA-BISSAU                         0      0     0
  CMIN Peru89 PERU                                0      0     0
  CMIN Peru95 PERU                                0      0     0
  CONTENT PERU                                    0      0     0
  EE PAKISTAN                                   329     33    15
  GMS-Nepal NEPAL                               486    124    85
  Guatemala BSC GUATEMALA                        76     88   118
  iLiNS-DOSE MALAWI                             592    566   710
  iLiNS-DYAD-M MALAWI                           415    492   331
  iLiNS-Zinc BURKINA FASO                         0      0     0
  IRC INDIA                                     147    139   124
  JiVitA-3 BANGLADESH                         10298   8633  9328
  JiVitA-4 BANGLADESH                          1789   1735  1902
  Keneba GAMBIA                                   0      0     0
  LCNI-5 MALAWI                                 261    255   298
  MAL-ED BANGLADESH                              70     66    78
  MAL-ED BRAZIL                                  63     90    79
  MAL-ED INDIA                                   76     81    63
  MAL-ED NEPAL                                   96     76    53
  MAL-ED PERU                                   104    107    91
  MAL-ED SOUTH AFRICA                           150     69    95
  MAL-ED TANZANIA, UNITED REPUBLIC OF            64    142    11
  NIH-Birth BANGLADESH                          230    220   179
  NIH-Crypto BANGLADESH                         242    262   254
  PROBIT BELARUS                               6160   8017  2869
  PROVIDE BANGLADESH                            214    251   235
  ResPak PAKISTAN                                 0      0     0
  SAS-CompFeed INDIA                           4245   3241  2055
  SAS-FoodSuppl INDIA                           332     45    41
  TanzaniaChild2 TANZANIA, UNITED REPUBLIC OF    82   1686   622
  TDC INDIA                                       0      0     0
  VITAMIN-A INDIA                              1962   1303   731
  ZVITAMBO ZIMBABWE                            2963   3477  7644
> table(paste0(d$studyid," ", d$country), d$feducyrs)
                                             
                                                Low Medium  High
  Burkina Faso Zn BURKINA FASO                    0      0     0
  CMC-V-BCS-2002 INDIA                            0      0     0
  CMIN Bangladesh93 BANGLADESH                    0      0     0
  CMIN Brazil89 BRAZIL                            0      0     0
  CMIN GB94 GUINEA-BISSAU                         0      0     0
  CMIN Peru89 PERU                                0      0     0
  CMIN Peru95 PERU                                0      0     0
  CONTENT PERU                                    0      0     0
  EE PAKISTAN                                     0      0     0
  GMS-Nepal NEPAL                               296    227   173
  Guatemala BSC GUATEMALA                         0      0     0
  iLiNS-DOSE MALAWI                             585    525   698
  iLiNS-DYAD-M MALAWI                           443    425   370
  iLiNS-Zinc BURKINA FASO                         0      0     0
  IRC INDIA                                       0      0     0
  JiVitA-3 BANGLADESH                         11254   9279  6707
  JiVitA-4 BANGLADESH                          1959   2076  1248
  Keneba GAMBIA                                   0      0     0
  LCNI-5 MALAWI                                 291    271   251
  MAL-ED BANGLADESH                              40     55    54
  MAL-ED BRAZIL                                   0      0     0
  MAL-ED INDIA                                   59     44    44
  MAL-ED NEPAL                                   28     28    42
  MAL-ED PERU                                    69     61   120
  MAL-ED SOUTH AFRICA                            37     30    43
  MAL-ED TANZANIA, UNITED REPUBLIC OF            61     21   130
  NIH-Birth BANGLADESH                            0      0     0
  NIH-Crypto BANGLADESH                         242    220   296
  PROBIT BELARUS                               6480   7234  2747
  PROVIDE BANGLADESH                            238    230   232
  ResPak PAKISTAN                                 0      0     0
  SAS-CompFeed INDIA                           3967   3061  2492
  SAS-FoodSuppl INDIA                           147    161   110
  TanzaniaChild2 TANZANIA, UNITED REPUBLIC OF  1273    665   449
  TDC INDIA                                       0      0     0
  VITAMIN-A INDIA                              1194   1102  1700
  ZVITAMBO ZIMBABWE                            2316  10404  1003
> 
> 
> 
> 
> #Categorize nrooms, nhh, nchild5
> table(d$nrooms)

    1     2     3     4     5     6     7     8     9    10    11    12    13 
24755 11903  4895  1923   717   343   147    81    40    32     7     8     3 
   14    15    77 
    4     6     2 
> table(paste0(d$studyid," ", d$country), d$nrooms)
                                             
                                                  1     2     3     4     5
  Burkina Faso Zn BURKINA FASO                    0     0     0     0     0
  CMC-V-BCS-2002 INDIA                          202   106    51    12     1
  CMIN Bangladesh93 BANGLADESH                    0     0     0     0     0
  CMIN Brazil89 BRAZIL                            0     0     0     0     0
  CMIN GB94 GUINEA-BISSAU                         0     0     0     0     0
  CMIN Peru89 PERU                                0     0     0     0     0
  CMIN Peru95 PERU                                0     0     0     0     0
  CONTENT PERU                                   44    54    39    35    26
  EE PAKISTAN                                     0     0     0     0     0
  GMS-Nepal NEPAL                                49   145   181   165    67
  Guatemala BSC GUATEMALA                         0     0     0     0     0
  iLiNS-DOSE MALAWI                             340   701   447   209    35
  iLiNS-DYAD-M MALAWI                           145   147    68    28    10
  iLiNS-Zinc BURKINA FASO                         0     0     0     0     0
  IRC INDIA                                     185   170    36    12     2
  JiVitA-3 BANGLADESH                         16754  7605  2723   800   260
  JiVitA-4 BANGLADESH                          3196  1389   562   185    60
  Keneba GAMBIA                                   0     0     0     0     0
  LCNI-5 MALAWI                                   0     0     0     0     0
  MAL-ED BANGLADESH                             152    50    28     9     1
  MAL-ED BRAZIL                                   4    20    59    58    36
  MAL-ED INDIA                                   84    78    48    21     2
  MAL-ED NEPAL                                   52    31    22    31    26
  MAL-ED PERU                                    19    52    62    57    43
  MAL-ED SOUTH AFRICA                            14    22    25    39    43
  MAL-ED TANZANIA, UNITED REPUBLIC OF            13    63    66    35    30
  NIH-Birth BANGLADESH                            0     0     0     0     0
  NIH-Crypto BANGLADESH                         368   191   104    57    25
  PROBIT BELARUS                                  0     0     0     0     0
  PROVIDE BANGLADESH                            507   108    62    13     6
  ResPak PAKISTAN                                 0     0     0     0     0
  SAS-CompFeed INDIA                              0     0     0     0     0
  SAS-FoodSuppl INDIA                             0     0     0     0     0
  TanzaniaChild2 TANZANIA, UNITED REPUBLIC OF     0     0     0     0     0
  TDC INDIA                                      91    49    15     4     0
  VITAMIN-A INDIA                              2536   922   297   153    44
  ZVITAMBO ZIMBABWE                               0     0     0     0     0
                                             
                                                  6     7     8     9    10
  Burkina Faso Zn BURKINA FASO                    0     0     0     0     0
  CMC-V-BCS-2002 INDIA                            1     0     0     0     0
  CMIN Bangladesh93 BANGLADESH                    0     0     0     0     0
  CMIN Brazil89 BRAZIL                            0     0     0     0     0
  CMIN GB94 GUINEA-BISSAU                         0     0     0     0     0
  CMIN Peru89 PERU                                0     0     0     0     0
  CMIN Peru95 PERU                                0     0     0     0     0
  CONTENT PERU                                    7     7     1     1     0
  EE PAKISTAN                                     0     0     0     0     0
  GMS-Nepal NEPAL                                52    17    12     2     5
  Guatemala BSC GUATEMALA                         0     0     0     0     0
  iLiNS-DOSE MALAWI                              13     3     3     0     0
  iLiNS-DYAD-M MALAWI                             0     0     0     5     0
  iLiNS-Zinc BURKINA FASO                         0     0     0     0     0
  IRC INDIA                                       1     2     0     0     0
  JiVitA-3 BANGLADESH                            88    23     9     0     1
  JiVitA-4 BANGLADESH                            23    10     6     0     1
  Keneba GAMBIA                                   0     0     0     0     0
  LCNI-5 MALAWI                                   0     0     0     0     0
  MAL-ED BANGLADESH                               2     0     0     0     0
  MAL-ED BRAZIL                                  17     9     3     2     1
  MAL-ED INDIA                                    2     0     0     0     0
  MAL-ED NEPAL                                   19    17    15     4     9
  MAL-ED PERU                                    23    12     3     0     1
  MAL-ED SOUTH AFRICA                            36    33    13    15     7
  MAL-ED TANZANIA, UNITED REPUBLIC OF            17    11     6     5     2
  NIH-Birth BANGLADESH                            0     0     0     0     0
  NIH-Crypto BANGLADESH                           7     1     2     2     1
  PROBIT BELARUS                                  0     0     0     0     0
  PROVIDE BANGLADESH                              2     1     0     1     0
  ResPak PAKISTAN                                 0     0     0     0     0
  SAS-CompFeed INDIA                              0     0     0     0     0
  SAS-FoodSuppl INDIA                             0     0     0     0     0
  TanzaniaChild2 TANZANIA, UNITED REPUBLIC OF     0     0     0     0     0
  TDC INDIA                                       1     0     0     0     0
  VITAMIN-A INDIA                                32     1     8     3     4
  ZVITAMBO ZIMBABWE                               0     0     0     0     0
                                             
                                                 11    12    13    14    15
  Burkina Faso Zn BURKINA FASO                    0     0     0     0     0
  CMC-V-BCS-2002 INDIA                            0     0     0     0     0
  CMIN Bangladesh93 BANGLADESH                    0     0     0     0     0
  CMIN Brazil89 BRAZIL                            0     0     0     0     0
  CMIN GB94 GUINEA-BISSAU                         0     0     0     0     0
  CMIN Peru89 PERU                                0     0     0     0     0
  CMIN Peru95 PERU                                0     0     0     0     0
  CONTENT PERU                                    1     0     0     0     0
  EE PAKISTAN                                     0     0     0     0     0
  GMS-Nepal NEPAL                                 1     0     0     1     1
  Guatemala BSC GUATEMALA                         0     0     0     0     0
  iLiNS-DOSE MALAWI                               0     0     0     0     0
  iLiNS-DYAD-M MALAWI                             0     0     0     0     0
  iLiNS-Zinc BURKINA FASO                         0     0     0     0     0
  IRC INDIA                                       0     0     0     0     0
  JiVitA-3 BANGLADESH                             0     0     0     0     0
  JiVitA-4 BANGLADESH                             0     0     1     0     0
  Keneba GAMBIA                                   0     0     0     0     0
  LCNI-5 MALAWI                                   0     0     0     0     0
  MAL-ED BANGLADESH                               0     0     0     0     0
  MAL-ED BRAZIL                                   0     0     0     1     0
  MAL-ED INDIA                                    0     0     0     0     0
  MAL-ED NEPAL                                    2     5     0     1     2
  MAL-ED PERU                                     0     0     0     0     0
  MAL-ED SOUTH AFRICA                             2     2     2     1     3
  MAL-ED TANZANIA, UNITED REPUBLIC OF             1     1     0     0     0
  NIH-Birth BANGLADESH                            0     0     0     0     0
  NIH-Crypto BANGLADESH                           0     0     0     0     0
  PROBIT BELARUS                                  0     0     0     0     0
  PROVIDE BANGLADESH                              0     0     0     0     0
  ResPak PAKISTAN                                 0     0     0     0     0
  SAS-CompFeed INDIA                              0     0     0     0     0
  SAS-FoodSuppl INDIA                             0     0     0     0     0
  TanzaniaChild2 TANZANIA, UNITED REPUBLIC OF     0     0     0     0     0
  TDC INDIA                                       0     0     0     0     0
  VITAMIN-A INDIA                                 0     0     0     0     0
  ZVITAMBO ZIMBABWE                               0     0     0     0     0
                                             
                                                 77
  Burkina Faso Zn BURKINA FASO                    0
  CMC-V-BCS-2002 INDIA                            0
  CMIN Bangladesh93 BANGLADESH                    0
  CMIN Brazil89 BRAZIL                            0
  CMIN GB94 GUINEA-BISSAU                         0
  CMIN Peru89 PERU                                0
  CMIN Peru95 PERU                                0
  CONTENT PERU                                    0
  EE PAKISTAN                                     0
  GMS-Nepal NEPAL                                 0
  Guatemala BSC GUATEMALA                         0
  iLiNS-DOSE MALAWI                               2
  iLiNS-DYAD-M MALAWI                             0
  iLiNS-Zinc BURKINA FASO                         0
  IRC INDIA                                       0
  JiVitA-3 BANGLADESH                             0
  JiVitA-4 BANGLADESH                             0
  Keneba GAMBIA                                   0
  LCNI-5 MALAWI                                   0
  MAL-ED BANGLADESH                               0
  MAL-ED BRAZIL                                   0
  MAL-ED INDIA                                    0
  MAL-ED NEPAL                                    0
  MAL-ED PERU                                     0
  MAL-ED SOUTH AFRICA                             0
  MAL-ED TANZANIA, UNITED REPUBLIC OF             0
  NIH-Birth BANGLADESH                            0
  NIH-Crypto BANGLADESH                           0
  PROBIT BELARUS                                  0
  PROVIDE BANGLADESH                              0
  ResPak PAKISTAN                                 0
  SAS-CompFeed INDIA                              0
  SAS-FoodSuppl INDIA                             0
  TanzaniaChild2 TANZANIA, UNITED REPUBLIC OF     0
  TDC INDIA                                       0
  VITAMIN-A INDIA                                 0
  ZVITAMBO ZIMBABWE                               0
> nroom<-NA
> nroom[d$nrooms<2] <- "1"
> nroom[d$nrooms==2] <- "2"
> nroom[d$nrooms==3] <- "3"
> nroom[d$nrooms>3] <- "4+"
> d$nrooms <- as.factor(nroom)
> table(d$nrooms)

    1     2     3    4+ 
24755 11903  4895  3313 
> table(paste0(d$studyid," ", d$country), d$nrooms)
                                             
                                                  1     2     3    4+
  Burkina Faso Zn BURKINA FASO                    0     0     0     0
  CMC-V-BCS-2002 INDIA                          202   106    51    14
  CMIN Bangladesh93 BANGLADESH                    0     0     0     0
  CMIN Brazil89 BRAZIL                            0     0     0     0
  CMIN GB94 GUINEA-BISSAU                         0     0     0     0
  CMIN Peru89 PERU                                0     0     0     0
  CMIN Peru95 PERU                                0     0     0     0
  CONTENT PERU                                   44    54    39    78
  EE PAKISTAN                                     0     0     0     0
  GMS-Nepal NEPAL                                49   145   181   323
  Guatemala BSC GUATEMALA                         0     0     0     0
  iLiNS-DOSE MALAWI                             340   701   447   265
  iLiNS-DYAD-M MALAWI                           145   147    68    43
  iLiNS-Zinc BURKINA FASO                         0     0     0     0
  IRC INDIA                                     185   170    36    17
  JiVitA-3 BANGLADESH                         16754  7605  2723  1181
  JiVitA-4 BANGLADESH                          3196  1389   562   286
  Keneba GAMBIA                                   0     0     0     0
  LCNI-5 MALAWI                                   0     0     0     0
  MAL-ED BANGLADESH                             152    50    28    12
  MAL-ED BRAZIL                                   4    20    59   127
  MAL-ED INDIA                                   84    78    48    25
  MAL-ED NEPAL                                   52    31    22   131
  MAL-ED PERU                                    19    52    62   139
  MAL-ED SOUTH AFRICA                            14    22    25   196
  MAL-ED TANZANIA, UNITED REPUBLIC OF            13    63    66   108
  NIH-Birth BANGLADESH                            0     0     0     0
  NIH-Crypto BANGLADESH                         368   191   104    95
  PROBIT BELARUS                                  0     0     0     0
  PROVIDE BANGLADESH                            507   108    62    23
  ResPak PAKISTAN                                 0     0     0     0
  SAS-CompFeed INDIA                              0     0     0     0
  SAS-FoodSuppl INDIA                             0     0     0     0
  TanzaniaChild2 TANZANIA, UNITED REPUBLIC OF     0     0     0     0
  TDC INDIA                                      91    49    15     5
  VITAMIN-A INDIA                              2536   922   297   245
  ZVITAMBO ZIMBABWE                               0     0     0     0
> 
> 
> table(d$nhh)  

  1   2   3   4   5   6   7   8   9  10  11  12  13  14  15  16  17  18  20 
  7 107 735 924 838 584 406 228 127 107  49  39  15  13   7   5   5   2   1 
> table(paste0(d$studyid," ", d$country), d$nhh)
                                             
                                                1   2   3   4   5   6   7   8
  Burkina Faso Zn BURKINA FASO                  0   0   0   0   0   0   0   0
  CMC-V-BCS-2002 INDIA                          0   0   0   0   0   0   0   0
  CMIN Bangladesh93 BANGLADESH                  0   0   0   0   0   0   0   0
  CMIN Brazil89 BRAZIL                          0   0   0   0   0   0   0   0
  CMIN GB94 GUINEA-BISSAU                       0   0   0   0   0   0   0   0
  CMIN Peru89 PERU                              0   0   0   0   0   0   0   0
  CMIN Peru95 PERU                              0   0   0   0   0   0   0   0
  CONTENT PERU                                  0   0   0   0   0   0   0   0
  EE PAKISTAN                                   0   0   0   0   0   0   0   0
  GMS-Nepal NEPAL                               0   0   0   0   0   0   0   0
  Guatemala BSC GUATEMALA                       0   0   0   0   0   0   0   0
  iLiNS-DOSE MALAWI                             0   0   0   0   0   0   0   0
  iLiNS-DYAD-M MALAWI                           4  54  57  48  41  36  31  17
  iLiNS-Zinc BURKINA FASO                       0   0   0   0   0   0   0   0
  IRC INDIA                                     1  11  46  80  78  64  43  29
  JiVitA-3 BANGLADESH                           0   0   0   0   0   0   0   0
  JiVitA-4 BANGLADESH                           0   0   0   0   0   0   0   0
  Keneba GAMBIA                                 0   0   0   0   0   0   0   0
  LCNI-5 MALAWI                                 2  28 195 180 160 111  71  40
  MAL-ED BANGLADESH                             0   0   0   0   0   0   0   0
  MAL-ED BRAZIL                                 0   0   0   0   0   0   0   0
  MAL-ED INDIA                                  0   0   0   0   0   0   0   0
  MAL-ED NEPAL                                  0   0   0   0   0   0   0   0
  MAL-ED PERU                                   0   0   0   0   0   0   0   0
  MAL-ED SOUTH AFRICA                           0   0   0   0   0   0   0   0
  MAL-ED TANZANIA, UNITED REPUBLIC OF           0   0   0   0   0   0   0   0
  NIH-Birth BANGLADESH                          0   1 116 130 134  83  59  51
  NIH-Crypto BANGLADESH                         0   2 112 176 166 110  68  29
  PROBIT BELARUS                                0   0   0   0   0   0   0   0
  PROVIDE BANGLADESH                            0   2 138 198 124  84  67  26
  ResPak PAKISTAN                               0   0   0   0   0   0   0   0
  SAS-CompFeed INDIA                            0   0   0   0   0   0   0   0
  SAS-FoodSuppl INDIA                           0   0  38  73 110  77  50  30
  TanzaniaChild2 TANZANIA, UNITED REPUBLIC OF   0   0   0   0   0   0   0   0
  TDC INDIA                                     0   9  33  39  25  19  17   6
  VITAMIN-A INDIA                               0   0   0   0   0   0   0   0
  ZVITAMBO ZIMBABWE                             0   0   0   0   0   0   0   0
                                             
                                                9  10  11  12  13  14  15  16
  Burkina Faso Zn BURKINA FASO                  0   0   0   0   0   0   0   0
  CMC-V-BCS-2002 INDIA                          0   0   0   0   0   0   0   0
  CMIN Bangladesh93 BANGLADESH                  0   0   0   0   0   0   0   0
  CMIN Brazil89 BRAZIL                          0   0   0   0   0   0   0   0
  CMIN GB94 GUINEA-BISSAU                       0   0   0   0   0   0   0   0
  CMIN Peru89 PERU                              0   0   0   0   0   0   0   0
  CMIN Peru95 PERU                              0   0   0   0   0   0   0   0
  CONTENT PERU                                  0   0   0   0   0   0   0   0
  EE PAKISTAN                                   0   0   0   0   0   0   0   0
  GMS-Nepal NEPAL                               0   0   0   0   0   0   0   0
  Guatemala BSC GUATEMALA                       0   0   0   0   0   0   0   0
  iLiNS-DOSE MALAWI                             0   0   0   0   0   0   0   0
  iLiNS-DYAD-M MALAWI                           4   6   5   3   1   0   0   0
  iLiNS-Zinc BURKINA FASO                       0   0   0   0   0   0   0   0
  IRC INDIA                                    17  12  10   7   6   0   2   1
  JiVitA-3 BANGLADESH                           0   0   0   0   0   0   0   0
  JiVitA-4 BANGLADESH                           0   0   0   0   0   0   0   0
  Keneba GAMBIA                                 0   0   0   0   0   0   0   0
  LCNI-5 MALAWI                                16   9   1   2   2   0   0   0
  MAL-ED BANGLADESH                             0   0   0   0   0   0   0   0
  MAL-ED BRAZIL                                 0   0   0   0   0   0   0   0
  MAL-ED INDIA                                  0   0   0   0   0   0   0   0
  MAL-ED NEPAL                                  0   0   0   0   0   0   0   0
  MAL-ED PERU                                   0   0   0   0   0   0   0   0
  MAL-ED SOUTH AFRICA                           0   0   0   0   0   0   0   0
  MAL-ED TANZANIA, UNITED REPUBLIC OF           0   0   0   0   0   0   0   0
  NIH-Birth BANGLADESH                         21  15   7   3   3   3   0   2
  NIH-Crypto BANGLADESH                        29  28   9  18   1   6   3   0
  PROBIT BELARUS                                0   0   0   0   0   0   0   0
  PROVIDE BANGLADESH                           21  17  12   4   0   2   2   1
  ResPak PAKISTAN                               0   0   0   0   0   0   0   0
  SAS-CompFeed INDIA                            0   0   0   0   0   0   0   0
  SAS-FoodSuppl INDIA                          15  18   3   1   1   1   0   0
  TanzaniaChild2 TANZANIA, UNITED REPUBLIC OF   0   0   0   0   0   0   0   0
  TDC INDIA                                     4   2   2   1   1   1   0   1
  VITAMIN-A INDIA                               0   0   0   0   0   0   0   0
  ZVITAMBO ZIMBABWE                             0   0   0   0   0   0   0   0
                                             
                                               17  18  20
  Burkina Faso Zn BURKINA FASO                  0   0   0
  CMC-V-BCS-2002 INDIA                          0   0   0
  CMIN Bangladesh93 BANGLADESH                  0   0   0
  CMIN Brazil89 BRAZIL                          0   0   0
  CMIN GB94 GUINEA-BISSAU                       0   0   0
  CMIN Peru89 PERU                              0   0   0
  CMIN Peru95 PERU                              0   0   0
  CONTENT PERU                                  0   0   0
  EE PAKISTAN                                   0   0   0
  GMS-Nepal NEPAL                               0   0   0
  Guatemala BSC GUATEMALA                       0   0   0
  iLiNS-DOSE MALAWI                             0   0   0
  iLiNS-DYAD-M MALAWI                           0   0   0
  iLiNS-Zinc BURKINA FASO                       0   0   0
  IRC INDIA                                     2   0   1
  JiVitA-3 BANGLADESH                           0   0   0
  JiVitA-4 BANGLADESH                           0   0   0
  Keneba GAMBIA                                 0   0   0
  LCNI-5 MALAWI                                 0   0   0
  MAL-ED BANGLADESH                             0   0   0
  MAL-ED BRAZIL                                 0   0   0
  MAL-ED INDIA                                  0   0   0
  MAL-ED NEPAL                                  0   0   0
  MAL-ED PERU                                   0   0   0
  MAL-ED SOUTH AFRICA                           0   0   0
  MAL-ED TANZANIA, UNITED REPUBLIC OF           0   0   0
  NIH-Birth BANGLADESH                          0   1   0
  NIH-Crypto BANGLADESH                         1   0   0
  PROBIT BELARUS                                0   0   0
  PROVIDE BANGLADESH                            1   1   0
  ResPak PAKISTAN                               0   0   0
  SAS-CompFeed INDIA                            0   0   0
  SAS-FoodSuppl INDIA                           1   0   0
  TanzaniaChild2 TANZANIA, UNITED REPUBLIC OF   0   0   0
  TDC INDIA                                     0   0   0
  VITAMIN-A INDIA                               0   0   0
  ZVITAMBO ZIMBABWE                             0   0   0
> 
> nhh<-NA
> nhh[d$nhh<4] <- "3 or less"
> nhh[d$nhh>3 & d$nhh<6] <- "4-5"
> nhh[d$nhh>5 & d$nhh<8] <- "6-7"
> nhh[d$nhh>7] <- "8+"
> d$nhh <- as.factor(nhh)
> table(d$nhh)

3 or less       4-5       6-7        8+ 
      849      1762       990       598 
> table(paste0(d$studyid," ", d$country), d$nhh)
                                             
                                              3 or less 4-5 6-7  8+
  Burkina Faso Zn BURKINA FASO                        0   0   0   0
  CMC-V-BCS-2002 INDIA                                0   0   0   0
  CMIN Bangladesh93 BANGLADESH                        0   0   0   0
  CMIN Brazil89 BRAZIL                                0   0   0   0
  CMIN GB94 GUINEA-BISSAU                             0   0   0   0
  CMIN Peru89 PERU                                    0   0   0   0
  CMIN Peru95 PERU                                    0   0   0   0
  CONTENT PERU                                        0   0   0   0
  EE PAKISTAN                                         0   0   0   0
  GMS-Nepal NEPAL                                     0   0   0   0
  Guatemala BSC GUATEMALA                             0   0   0   0
  iLiNS-DOSE MALAWI                                   0   0   0   0
  iLiNS-DYAD-M MALAWI                               115  89  67  36
  iLiNS-Zinc BURKINA FASO                             0   0   0   0
  IRC INDIA                                          58 158 107  87
  JiVitA-3 BANGLADESH                                 0   0   0   0
  JiVitA-4 BANGLADESH                                 0   0   0   0
  Keneba GAMBIA                                       0   0   0   0
  LCNI-5 MALAWI                                     225 340 182  70
  MAL-ED BANGLADESH                                   0   0   0   0
  MAL-ED BRAZIL                                       0   0   0   0
  MAL-ED INDIA                                        0   0   0   0
  MAL-ED NEPAL                                        0   0   0   0
  MAL-ED PERU                                         0   0   0   0
  MAL-ED SOUTH AFRICA                                 0   0   0   0
  MAL-ED TANZANIA, UNITED REPUBLIC OF                 0   0   0   0
  NIH-Birth BANGLADESH                              117 264 142 106
  NIH-Crypto BANGLADESH                             114 342 178 124
  PROBIT BELARUS                                      0   0   0   0
  PROVIDE BANGLADESH                                140 322 151  87
  ResPak PAKISTAN                                     0   0   0   0
  SAS-CompFeed INDIA                                  0   0   0   0
  SAS-FoodSuppl INDIA                                38 183 127  70
  TanzaniaChild2 TANZANIA, UNITED REPUBLIC OF         0   0   0   0
  TDC INDIA                                          42  64  36  18
  VITAMIN-A INDIA                                     0   0   0   0
  ZVITAMBO ZIMBABWE                                   0   0   0   0
> 
> 
> table(d$nchldlt5)

    1     2     3     4     5     6     7     8    10    11 
23357 13199  1535   384   107    30    11     3     3     2 
> table(paste0(d$studyid," ", d$country), d$nchldlt5)
                                             
                                                  1     2     3     4     5
  Burkina Faso Zn BURKINA FASO                    0     0     0     0     0
  CMC-V-BCS-2002 INDIA                            0     0     0     0     0
  CMIN Bangladesh93 BANGLADESH                    0     0     0     0     0
  CMIN Brazil89 BRAZIL                            0     0     0     0     0
  CMIN GB94 GUINEA-BISSAU                         0     0     0     0     0
  CMIN Peru89 PERU                                0     0     0     0     0
  CMIN Peru95 PERU                                0     0     0     0     0
  CONTENT PERU                                    0     0     0     0     0
  EE PAKISTAN                                     0     0     0     0     0
  GMS-Nepal NEPAL                                 0     0     0     0     0
  Guatemala BSC GUATEMALA                         0     0     0     0     0
  iLiNS-DOSE MALAWI                             845   817   119    24     5
  iLiNS-DYAD-M MALAWI                            66   174    42     7     4
  iLiNS-Zinc BURKINA FASO                      1073  1272   525   231    68
  IRC INDIA                                      89   119   100    62    22
  JiVitA-3 BANGLADESH                         18200  9402   617    42     4
  JiVitA-4 BANGLADESH                             0     0     0     0     0
  Keneba GAMBIA                                   0     0     0     0     0
  LCNI-5 MALAWI                                 391   358    51     9     1
  MAL-ED BANGLADESH                               0     0     0     0     0
  MAL-ED BRAZIL                                   0     0     0     0     0
  MAL-ED INDIA                                    0     0     0     0     0
  MAL-ED NEPAL                                    0     0     0     0     0
  MAL-ED PERU                                     0     0     0     0     0
  MAL-ED SOUTH AFRICA                             0     0     0     0     0
  MAL-ED TANZANIA, UNITED REPUBLIC OF             0     0     0     0     0
  NIH-Birth BANGLADESH                            0     0     0     0     0
  NIH-Crypto BANGLADESH                         541   211     6     0     0
  PROBIT BELARUS                                  0     0     0     0     0
  PROVIDE BANGLADESH                            512   176    12     0     0
  ResPak PAKISTAN                                 0     0     0     0     0
  SAS-CompFeed INDIA                              0     0     0     0     0
  SAS-FoodSuppl INDIA                             0     0     0     0     0
  TanzaniaChild2 TANZANIA, UNITED REPUBLIC OF  1640   670    63     9     3
  TDC INDIA                                       0     0     0     0     0
  VITAMIN-A INDIA                                 0     0     0     0     0
  ZVITAMBO ZIMBABWE                               0     0     0     0     0
                                             
                                                  6     7     8    10    11
  Burkina Faso Zn BURKINA FASO                    0     0     0     0     0
  CMC-V-BCS-2002 INDIA                            0     0     0     0     0
  CMIN Bangladesh93 BANGLADESH                    0     0     0     0     0
  CMIN Brazil89 BRAZIL                            0     0     0     0     0
  CMIN GB94 GUINEA-BISSAU                         0     0     0     0     0
  CMIN Peru89 PERU                                0     0     0     0     0
  CMIN Peru95 PERU                                0     0     0     0     0
  CONTENT PERU                                    0     0     0     0     0
  EE PAKISTAN                                     0     0     0     0     0
  GMS-Nepal NEPAL                                 0     0     0     0     0
  Guatemala BSC GUATEMALA                         0     0     0     0     0
  iLiNS-DOSE MALAWI                               2     0     0     0     0
  iLiNS-DYAD-M MALAWI                             0     1     0     0     1
  iLiNS-Zinc BURKINA FASO                        15     4     1     0     0
  IRC INDIA                                      12     4     2     0     0
  JiVitA-3 BANGLADESH                             1     0     0     0     0
  JiVitA-4 BANGLADESH                             0     0     0     0     0
  Keneba GAMBIA                                   0     0     0     0     0
  LCNI-5 MALAWI                                   0     1     0     0     1
  MAL-ED BANGLADESH                               0     0     0     0     0
  MAL-ED BRAZIL                                   0     0     0     0     0
  MAL-ED INDIA                                    0     0     0     0     0
  MAL-ED NEPAL                                    0     0     0     0     0
  MAL-ED PERU                                     0     0     0     0     0
  MAL-ED SOUTH AFRICA                             0     0     0     0     0
  MAL-ED TANZANIA, UNITED REPUBLIC OF             0     0     0     0     0
  NIH-Birth BANGLADESH                            0     0     0     0     0
  NIH-Crypto BANGLADESH                           0     0     0     0     0
  PROBIT BELARUS                                  0     0     0     0     0
  PROVIDE BANGLADESH                              0     0     0     0     0
  ResPak PAKISTAN                                 0     0     0     0     0
  SAS-CompFeed INDIA                              0     0     0     0     0
  SAS-FoodSuppl INDIA                             0     0     0     0     0
  TanzaniaChild2 TANZANIA, UNITED REPUBLIC OF     0     1     0     3     0
  TDC INDIA                                       0     0     0     0     0
  VITAMIN-A INDIA                                 0     0     0     0     0
  ZVITAMBO ZIMBABWE                               0     0     0     0     0
> 
> nchild5<-NA
> nchild5[d$nchldlt5==1] <- "1"
> nchild5[d$nchldlt5>=2] <- "2+"
> d$nchldlt5 <- as.factor(nchild5)
> table(d$nchldlt5)

    1    2+ 
23357 15274 
> table(paste0(d$studyid," ", d$country), d$nchldlt5)
                                             
                                                  1    2+
  Burkina Faso Zn BURKINA FASO                    0     0
  CMC-V-BCS-2002 INDIA                            0     0
  CMIN Bangladesh93 BANGLADESH                    0     0
  CMIN Brazil89 BRAZIL                            0     0
  CMIN GB94 GUINEA-BISSAU                         0     0
  CMIN Peru89 PERU                                0     0
  CMIN Peru95 PERU                                0     0
  CONTENT PERU                                    0     0
  EE PAKISTAN                                     0     0
  GMS-Nepal NEPAL                                 0     0
  Guatemala BSC GUATEMALA                         0     0
  iLiNS-DOSE MALAWI                             845   967
  iLiNS-DYAD-M MALAWI                            66   229
  iLiNS-Zinc BURKINA FASO                      1073  2116
  IRC INDIA                                      89   321
  JiVitA-3 BANGLADESH                         18200 10066
  JiVitA-4 BANGLADESH                             0     0
  Keneba GAMBIA                                   0     0
  LCNI-5 MALAWI                                 391   421
  MAL-ED BANGLADESH                               0     0
  MAL-ED BRAZIL                                   0     0
  MAL-ED INDIA                                    0     0
  MAL-ED NEPAL                                    0     0
  MAL-ED PERU                                     0     0
  MAL-ED SOUTH AFRICA                             0     0
  MAL-ED TANZANIA, UNITED REPUBLIC OF             0     0
  NIH-Birth BANGLADESH                            0     0
  NIH-Crypto BANGLADESH                         541   217
  PROBIT BELARUS                                  0     0
  PROVIDE BANGLADESH                            512   188
  ResPak PAKISTAN                                 0     0
  SAS-CompFeed INDIA                              0     0
  SAS-FoodSuppl INDIA                             0     0
  TanzaniaChild2 TANZANIA, UNITED REPUBLIC OF  1640   749
  TDC INDIA                                       0     0
  VITAMIN-A INDIA                                 0     0
  ZVITAMBO ZIMBABWE                               0     0
> 
> d$nchldlt5 <- relevel(d$nchldlt5, ref="1")
> 
> table(d$parity)

    1     2     3     4     5     6     7     8     9    10    11    12    13 
22856 18384 10900  6315  2476  2332   568   347   513   125    63    32     6 
   14    15    16    19 
    5     2     1     2 
> table(paste0(d$studyid," ", d$country), d$parity)
                                             
                                                  1     2     3     4     5
  Burkina Faso Zn BURKINA FASO                 1321  1197   994  1355     0
  CMC-V-BCS-2002 INDIA                            0     0     0     0     0
  CMIN Bangladesh93 BANGLADESH                    0     0     0     0     0
  CMIN Brazil89 BRAZIL                            0     0     0     0     0
  CMIN GB94 GUINEA-BISSAU                         0     0     0     0     0
  CMIN Peru89 PERU                                0     0     0     0     0
  CMIN Peru95 PERU                                0     0     0     0     0
  CONTENT PERU                                    0     0     0     0     0
  EE PAKISTAN                                     0     0     0     0     0
  GMS-Nepal NEPAL                               211   181   128    89    48
  Guatemala BSC GUATEMALA                         0     0     0     0     0
  iLiNS-DOSE MALAWI                               0     0     0     0     0
  iLiNS-DYAD-M MALAWI                           224   279   270   206   160
  iLiNS-Zinc BURKINA FASO                         0     0     0     0     0
  IRC INDIA                                       0     0     0     0     0
  JiVitA-3 BANGLADESH                         10849  9236  4840  2076   787
  JiVitA-4 BANGLADESH                             0     0     0     0     0
  Keneba GAMBIA                                 241   215   233   238   223
  LCNI-5 MALAWI                                   0     0     0     0     0
  MAL-ED BANGLADESH                               0     0     0     0     0
  MAL-ED BRAZIL                                   0     0     0     0     0
  MAL-ED INDIA                                    0     0     0     0     0
  MAL-ED NEPAL                                    0     0     0     0     0
  MAL-ED PERU                                     0     0     0     0     0
  MAL-ED SOUTH AFRICA                             0     0     0     0     0
  MAL-ED TANZANIA, UNITED REPUBLIC OF             0     0     0     0     0
  NIH-Birth BANGLADESH                            0     0     0     0     0
  NIH-Crypto BANGLADESH                           0     0     0     0     0
  PROBIT BELARUS                                  0     0     0     0     0
  PROVIDE BANGLADESH                            271   244   103    50    21
  ResPak PAKISTAN                                 0     0     0     0     0
  SAS-CompFeed INDIA                           2807  2214  2012  1180   696
  SAS-FoodSuppl INDIA                            21    77    92    74    54
  TanzaniaChild2 TANZANIA, UNITED REPUBLIC OF   776   459   188    71    22
  TDC INDIA                                      48    64    39     7     2
  VITAMIN-A INDIA                                 0     0     0     0     0
  ZVITAMBO ZIMBABWE                            6087  4218  2001   969   463
                                             
                                                  6     7     8     9    10
  Burkina Faso Zn BURKINA FASO                 1095     0     0   283     0
  CMC-V-BCS-2002 INDIA                            0     0     0     0     0
  CMIN Bangladesh93 BANGLADESH                    0     0     0     0     0
  CMIN Brazil89 BRAZIL                            0     0     0     0     0
  CMIN GB94 GUINEA-BISSAU                         0     0     0     0     0
  CMIN Peru89 PERU                                0     0     0     0     0
  CMIN Peru95 PERU                                0     0     0     0     0
  CONTENT PERU                                    0     0     0     0     0
  EE PAKISTAN                                     0     0     0     0     0
  GMS-Nepal NEPAL                                19     5     9     4     3
  Guatemala BSC GUATEMALA                         0     0     0     0     0
  iLiNS-DOSE MALAWI                               0     0     0     0     0
  iLiNS-DYAD-M MALAWI                            66    24     6     3     0
  iLiNS-Zinc BURKINA FASO                         0     0     0     0     0
  IRC INDIA                                       0     0     0     0     0
  JiVitA-3 BANGLADESH                           303   130    44    19     9
  JiVitA-4 BANGLADESH                             0     0     0     0     0
  Keneba GAMBIA                                 231   173   125   129    94
  LCNI-5 MALAWI                                   0     0     0     0     0
  MAL-ED BANGLADESH                               0     0     0     0     0
  MAL-ED BRAZIL                                   0     0     0     0     0
  MAL-ED INDIA                                    0     0     0     0     0
  MAL-ED NEPAL                                    0     0     0     0     0
  MAL-ED PERU                                     0     0     0     0     0
  MAL-ED SOUTH AFRICA                             0     0     0     0     0
  MAL-ED TANZANIA, UNITED REPUBLIC OF             0     0     0     0     0
  NIH-Birth BANGLADESH                            0     0     0     0     0
  NIH-Crypto BANGLADESH                           0     0     0     0     0
  PROBIT BELARUS                                  0     0     0     0     0
  PROVIDE BANGLADESH                              6     3     1     0     1
  ResPak PAKISTAN                                 0     0     0     0     0
  SAS-CompFeed INDIA                            329   118   121    56     7
  SAS-FoodSuppl INDIA                            58    23    11     5     1
  TanzaniaChild2 TANZANIA, UNITED REPUBLIC OF     5     2     0     0     0
  TDC INDIA                                       0     0     0     0     0
  VITAMIN-A INDIA                                 0     0     0     0     0
  ZVITAMBO ZIMBABWE                             220    90    30    14    10
                                             
                                                 11    12    13    14    15
  Burkina Faso Zn BURKINA FASO                    0     0     0     0     0
  CMC-V-BCS-2002 INDIA                            0     0     0     0     0
  CMIN Bangladesh93 BANGLADESH                    0     0     0     0     0
  CMIN Brazil89 BRAZIL                            0     0     0     0     0
  CMIN GB94 GUINEA-BISSAU                         0     0     0     0     0
  CMIN Peru89 PERU                                0     0     0     0     0
  CMIN Peru95 PERU                                0     0     0     0     0
  CONTENT PERU                                    0     0     0     0     0
  EE PAKISTAN                                     0     0     0     0     0
  GMS-Nepal NEPAL                                 1     0     0     0     0
  Guatemala BSC GUATEMALA                         0     0     0     0     0
  iLiNS-DOSE MALAWI                               0     0     0     0     0
  iLiNS-DYAD-M MALAWI                             0     0     0     0     0
  iLiNS-Zinc BURKINA FASO                         0     0     0     0     0
  IRC INDIA                                       0     0     0     0     0
  JiVitA-3 BANGLADESH                             5     1     0     1     0
  JiVitA-4 BANGLADESH                             0     0     0     0     0
  Keneba GAMBIA                                  54    30     6     4     2
  LCNI-5 MALAWI                                   0     0     0     0     0
  MAL-ED BANGLADESH                               0     0     0     0     0
  MAL-ED BRAZIL                                   0     0     0     0     0
  MAL-ED INDIA                                    0     0     0     0     0
  MAL-ED NEPAL                                    0     0     0     0     0
  MAL-ED PERU                                     0     0     0     0     0
  MAL-ED SOUTH AFRICA                             0     0     0     0     0
  MAL-ED TANZANIA, UNITED REPUBLIC OF             0     0     0     0     0
  NIH-Birth BANGLADESH                            0     0     0     0     0
  NIH-Crypto BANGLADESH                           0     0     0     0     0
  PROBIT BELARUS                                  0     0     0     0     0
  PROVIDE BANGLADESH                              0     0     0     0     0
  ResPak PAKISTAN                                 0     0     0     0     0
  SAS-CompFeed INDIA                              0     1     0     0     0
  SAS-FoodSuppl INDIA                             2     0     0     0     0
  TanzaniaChild2 TANZANIA, UNITED REPUBLIC OF     0     0     0     0     0
  TDC INDIA                                       0     0     0     0     0
  VITAMIN-A INDIA                                 0     0     0     0     0
  ZVITAMBO ZIMBABWE                               1     0     0     0     0
                                             
                                                 16    19
  Burkina Faso Zn BURKINA FASO                    0     0
  CMC-V-BCS-2002 INDIA                            0     0
  CMIN Bangladesh93 BANGLADESH                    0     0
  CMIN Brazil89 BRAZIL                            0     0
  CMIN GB94 GUINEA-BISSAU                         0     0
  CMIN Peru89 PERU                                0     0
  CMIN Peru95 PERU                                0     0
  CONTENT PERU                                    0     0
  EE PAKISTAN                                     0     0
  GMS-Nepal NEPAL                                 0     0
  Guatemala BSC GUATEMALA                         0     0
  iLiNS-DOSE MALAWI                               0     0
  iLiNS-DYAD-M MALAWI                             0     0
  iLiNS-Zinc BURKINA FASO                         0     0
  IRC INDIA                                       0     0
  JiVitA-3 BANGLADESH                             0     0
  JiVitA-4 BANGLADESH                             0     0
  Keneba GAMBIA                                   0     2
  LCNI-5 MALAWI                                   0     0
  MAL-ED BANGLADESH                               0     0
  MAL-ED BRAZIL                                   0     0
  MAL-ED INDIA                                    0     0
  MAL-ED NEPAL                                    0     0
  MAL-ED PERU                                     0     0
  MAL-ED SOUTH AFRICA                             0     0
  MAL-ED TANZANIA, UNITED REPUBLIC OF             0     0
  NIH-Birth BANGLADESH                            0     0
  NIH-Crypto BANGLADESH                           0     0
  PROBIT BELARUS                                  0     0
  PROVIDE BANGLADESH                              0     0
  ResPak PAKISTAN                                 0     0
  SAS-CompFeed INDIA                              0     0
  SAS-FoodSuppl INDIA                             0     0
  TanzaniaChild2 TANZANIA, UNITED REPUBLIC OF     1     0
  TDC INDIA                                       0     0
  VITAMIN-A INDIA                                 0     0
  ZVITAMBO ZIMBABWE                               0     0
> 
> parity<-NA
> parity[d$parity==1] <- "1"
> parity[d$parity==2] <- "2"
> parity[d$parity>2] <- "3+"
> d$parity <- as.factor(parity)
> table(d$parity)

    1     2    3+ 
22856 18384 23687 
> table(paste0(d$studyid," ", d$country), d$parity)
                                             
                                                  1     2    3+
  Burkina Faso Zn BURKINA FASO                 1321  1197  3727
  CMC-V-BCS-2002 INDIA                            0     0     0
  CMIN Bangladesh93 BANGLADESH                    0     0     0
  CMIN Brazil89 BRAZIL                            0     0     0
  CMIN GB94 GUINEA-BISSAU                         0     0     0
  CMIN Peru89 PERU                                0     0     0
  CMIN Peru95 PERU                                0     0     0
  CONTENT PERU                                    0     0     0
  EE PAKISTAN                                     0     0     0
  GMS-Nepal NEPAL                               211   181   306
  Guatemala BSC GUATEMALA                         0     0     0
  iLiNS-DOSE MALAWI                               0     0     0
  iLiNS-DYAD-M MALAWI                           224   279   735
  iLiNS-Zinc BURKINA FASO                         0     0     0
  IRC INDIA                                       0     0     0
  JiVitA-3 BANGLADESH                         10849  9236  8215
  JiVitA-4 BANGLADESH                             0     0     0
  Keneba GAMBIA                                 241   215  1544
  LCNI-5 MALAWI                                   0     0     0
  MAL-ED BANGLADESH                               0     0     0
  MAL-ED BRAZIL                                   0     0     0
  MAL-ED INDIA                                    0     0     0
  MAL-ED NEPAL                                    0     0     0
  MAL-ED PERU                                     0     0     0
  MAL-ED SOUTH AFRICA                             0     0     0
  MAL-ED TANZANIA, UNITED REPUBLIC OF             0     0     0
  NIH-Birth BANGLADESH                            0     0     0
  NIH-Crypto BANGLADESH                           0     0     0
  PROBIT BELARUS                                  0     0     0
  PROVIDE BANGLADESH                            271   244   185
  ResPak PAKISTAN                                 0     0     0
  SAS-CompFeed INDIA                           2807  2214  4520
  SAS-FoodSuppl INDIA                            21    77   320
  TanzaniaChild2 TANZANIA, UNITED REPUBLIC OF   776   459   289
  TDC INDIA                                      48    64    48
  VITAMIN-A INDIA                                 0     0     0
  ZVITAMBO ZIMBABWE                            6087  4218  3798
> 
> 
> 
> d$parity <- relevel(d$parity, ref="1")
> 
> 
> 
> 
> #---------------------------------------
> # Set reference levels
> #---------------------------------------
> 
> #birthweight
> # Low birth weight: < 2500
> # healthy birth weight 2500-4200
> 
> d$birthwt <- relevel(d$birthwt, ref="Normal or high birthweight")
> 
> 
> #birth length: 
> #No WHO categories:
> #Based on quantiles
> 
> d$birthlen <- relevel(d$birthlen, ref=">=50 cm")
> 
> #wealth index: 
> #wealthiest quartile - Q4 is baseline
> table(paste0(d$studyid," ", d$country), d$hhwealth_quart)
                                             
                                              WealthQ4 WealthQ3 WealthQ2
  Burkina Faso Zn BURKINA FASO                       0        0        0
  CMC-V-BCS-2002 INDIA                              96       91       95
  CMIN Bangladesh93 BANGLADESH                       0        0        0
  CMIN Brazil89 BRAZIL                               0        0        0
  CMIN GB94 GUINEA-BISSAU                            0        0        0
  CMIN Peru89 PERU                                   0        0        0
  CMIN Peru95 PERU                                   0        0        0
  CONTENT PERU                                      60       56       47
  EE PAKISTAN                                        0        0        0
  GMS-Nepal NEPAL                                  175      174      174
  Guatemala BSC GUATEMALA                            0        0        0
  iLiNS-DOSE MALAWI                                470      469      470
  iLiNS-DYAD-M MALAWI                              312      309      312
  iLiNS-Zinc BURKINA FASO                            0        0        0
  IRC INDIA                                        100      103      102
  JiVitA-3 BANGLADESH                             7485     7010     6939
  JiVitA-4 BANGLADESH                             1359     1358     1361
  Keneba GAMBIA                                      0        0        0
  LCNI-5 MALAWI                                    193      214      183
  MAL-ED BANGLADESH                                 61       60       60
  MAL-ED BRAZIL                                     53       52       52
  MAL-ED INDIA                                      59       59       58
  MAL-ED NEPAL                                      59       59       59
  MAL-ED PERU                                       68       68       68
  MAL-ED SOUTH AFRICA                               65       64       64
  MAL-ED TANZANIA, UNITED REPUBLIC OF               63       62       62
  NIH-Birth BANGLADESH                               0        0        0
  NIH-Crypto BANGLADESH                              0        0        0
  PROBIT BELARUS                                     0        0        0
  PROVIDE BANGLADESH                               181      169      175
  ResPak PAKISTAN                                    0        0        0
  SAS-CompFeed INDIA                                 0        0        0
  SAS-FoodSuppl INDIA                                0        0        0
  TanzaniaChild2 TANZANIA, UNITED REPUBLIC OF      565      433      610
  TDC INDIA                                         40       40       40
  VITAMIN-A INDIA                                    0        0        0
  ZVITAMBO ZIMBABWE                                  0        0        0
                                             
                                              WealthQ1
  Burkina Faso Zn BURKINA FASO                       0
  CMC-V-BCS-2002 INDIA                              91
  CMIN Bangladesh93 BANGLADESH                       0
  CMIN Brazil89 BRAZIL                               0
  CMIN GB94 GUINEA-BISSAU                            0
  CMIN Peru89 PERU                                   0
  CMIN Peru95 PERU                                   0
  CONTENT PERU                                      52
  EE PAKISTAN                                        0
  GMS-Nepal NEPAL                                  175
  Guatemala BSC GUATEMALA                            0
  iLiNS-DOSE MALAWI                                470
  iLiNS-DYAD-M MALAWI                              305
  iLiNS-Zinc BURKINA FASO                            0
  IRC INDIA                                        105
  JiVitA-3 BANGLADESH                             6835
  JiVitA-4 BANGLADESH                             1355
  Keneba GAMBIA                                      0
  LCNI-5 MALAWI                                    227
  MAL-ED BANGLADESH                                 61
  MAL-ED BRAZIL                                     53
  MAL-ED INDIA                                      59
  MAL-ED NEPAL                                      59
  MAL-ED PERU                                       68
  MAL-ED SOUTH AFRICA                               64
  MAL-ED TANZANIA, UNITED REPUBLIC OF               63
  NIH-Birth BANGLADESH                               0
  NIH-Crypto BANGLADESH                              0
  PROBIT BELARUS                                     0
  PROVIDE BANGLADESH                               175
  ResPak PAKISTAN                                    0
  SAS-CompFeed INDIA                                 0
  SAS-FoodSuppl INDIA                                0
  TanzaniaChild2 TANZANIA, UNITED REPUBLIC OF      780
  TDC INDIA                                         40
  VITAMIN-A INDIA                                    0
  ZVITAMBO ZIMBABWE                                  0
> d$hhwealth_quart <- relevel(d$hhwealth_quart, ref="WealthQ4")
> 
> # children < 5 in HH
> #not sure how this could be zero - can you double check this? 
> #baseline should be smallest number
> 
> d$nchldlt5 <- relevel(d$nchldlt5, ref="1")
> 
> #gestational age at birth
> #<37 weeks = preterm
> #37-38 weeks = early term
> #39-40 weeks = full term (baseline)
> #>=41 weeks = late/post term
> 
> d$gagebrth <- relevel(d$gagebrth, ref="Full or late term")
> 
> #maternal BMI (is this measured when pregnant or not? if pregnant, then we may need to change these categories)
> #<18.5 = underweight
> #>=18.5 and <25 = normal weight (baseline)
> #>=25 and <30 = overweight
> #>=30 = obese
> 
> d$mbmi <- relevel(d$mbmi, ref="Normal weight")
> 
> #maternal height (https://www.ncbi.nlm.nih.gov/pmc/articles/PMC3095774/)
> #less than 145 cm
> #145-149.9 cm
> #150-154.9 cm
> #155-159.9 cm
> #160.0 cm or greater. (baseline)
> 
> d$mhtcm <- relevel(d$mhtcm, ref=">=155 cm")
> 
> #maternal weight?
> d$mwtkg <- relevel(d$mwtkg, ref=">=58 kg")
> 
> #mother's/father's education
> #lowest education level = baseline
> d$meducyrs <- relevel(factor(d$meducyrs), ref="Low")
> d$feducyrs <- relevel(factor(d$feducyrs), ref="Low")
> 
> #mother's age
> #middle = baseline
> d$mage <- relevel(d$mage, ref="[20-30)")
> 
> #father age
> #oldest = baseline
> d$fage <- relevel(d$fage, ref=">=38")
> 
> #father height
> d$fhtcm <- relevel(d$fhtcm, ref=">=167 cm")
> 
> #parental education
> d$meducyrs <- relevel(d$meducyrs, ref="High")
> d$feducyrs <- relevel(d$feducyrs, ref="High")
> 
> #number of rooms
> d$nrooms <- relevel(d$nrooms, ref="4+")
> 
> 
> 
> #Set remaining risk factors to factors
> d$brthmon <- factor(d$brthmon)
> d$month <- factor(d$month)
> d$single <- factor(d$single)
> d$vagbrth <- factor(d$vagbrth)
> d$hdlvry <- factor(d$hdlvry)
> d$hfoodsec <- factor(d$hfoodsec)
> d$enstunt <- factor(d$enstunt)
> d$sex <- factor(d$sex)
> d$meducyrs <- factor(d$meducyrs)
> 
> #Check that all risk factor variables are set as factors
> d<-as.data.frame(d)
> for(i in 1:ncol(d)){
+   cat(colnames(d)[i], ": ", class(d[,i]), "\n")
+ }
studyid :  character 
subjid :  character 
sex :  factor 
month :  factor 
country :  character 
region :  character 
arm :  character 
tr :  character 
gagebrth :  factor 
brthmon :  factor 
parity :  factor 
birthwt :  factor 
birthlen :  factor 
vagbrth :  factor 
hdlvry :  factor 
mage :  factor 
mhtcm :  factor 
mwtkg :  factor 
mbmi :  factor 
meducyrs :  factor 
single :  factor 
fage :  factor 
fhtcm :  factor 
feducyrs :  factor 
trth2o :  integer 
cleanck :  integer 
impfloor :  integer 
nrooms :  factor 
nhh :  factor 
nchldlt5 :  factor 
ses :  character 
earlybf :  integer 
hfoodsec :  factor 
measurefreq :  character 
anywast06 :  numeric 
pers_wast :  numeric 
enstunt :  factor 
enwast :  numeric 
hhwealth_quart :  factor 
id :  character 
W_gagebrth :  integer 
W_birthwt :  numeric 
W_birthlen :  numeric 
W_mage :  numeric 
W_mhtcm :  numeric 
W_mwtkg :  numeric 
W_mbmi :  numeric 
W_fage :  integer 
W_fhtcm :  numeric 
W_meducyrs :  integer 
W_feducyrs :  integer 
W_nrooms :  integer 
W_nhh :  integer 
W_nchldlt5 :  numeric 
W_parity :  numeric 
> 
> 
> 
> #Tabulate missingness
> for(i in 1:ncol(d)){
+   print(colnames(d)[i])
+   print(table(is.na(d[,i])))
+   print(levels(d[,i]))
+ }
[1] "studyid"

 FALSE 
107636 
NULL
[1] "subjid"

 FALSE 
107636 
NULL
[1] "sex"

 FALSE 
107636 
[1] "Female" "Male"  
[1] "month"

 FALSE   TRUE 
106177   1459 
 [1] "1"  "2"  "3"  "4"  "5"  "6"  "7"  "8"  "9"  "10" "11" "12"
[1] "country"

 FALSE 
107636 
NULL
[1] "region"

 FALSE   TRUE 
107476    160 
NULL
[1] "arm"

 FALSE   TRUE 
107476    160 
NULL
[1] "tr"

FALSE  TRUE 
97189 10447 
NULL
[1] "gagebrth"

FALSE  TRUE 
50537 57099 
[1] "Full or late term" "Preterm"           "Early term"       
[1] "brthmon"

 FALSE   TRUE 
106877    759 
 [1] "1"  "2"  "3"  "4"  "5"  "6"  "7"  "8"  "9"  "10" "11" "12"
[1] "parity"

FALSE  TRUE 
64927 42709 
[1] "1"  "2"  "3+"
[1] "birthwt"

FALSE  TRUE 
79038 28598 
[1] "Normal or high birthweight" "Low birthweight"           
[1] "birthlen"

FALSE  TRUE 
71944 35692 
[1] ">=50 cm"    "<48 cm"     "[48-50) cm"
[1] "vagbrth"

FALSE  TRUE 
68448 39188 
[1] "0" "1"
[1] "hdlvry"

FALSE  TRUE 
19929 87707 
[1] "0" "1"
[1] "mage"

FALSE  TRUE 
97898  9738 
[1] "[20-30)" "<20"     ">=30"   
[1] "mhtcm"

FALSE  TRUE 
83198 24438 
[1] ">=155 cm"     "<151 cm"      "[151-155) cm"
[1] "mwtkg"

FALSE  TRUE 
82073 25563 
[1] ">=58 kg"    "<52 kg"     "[52-58) kg"
[1] "mbmi"

FALSE  TRUE 
79813 27823 
[1] "Normal weight" "Underweight"  
[1] "meducyrs"

FALSE  TRUE 
96984 10652 
[1] "High"   "Low"    "Medium"
[1] "single"

FALSE  TRUE 
44164 63472 
[1] "0" "1"
[1] "fage"

FALSE  TRUE 
30118 77518 
[1] ">=38"    "<32"     "[32-38)"
[1] "fhtcm"

FALSE  TRUE 
20636 87000 
[1] ">=167 cm"     "<162 cm"      "[162-167) cm"
[1] "feducyrs"

FALSE  TRUE 
86007 21629 
[1] "High"   "Low"    "Medium"
[1] "trth2o"

 FALSE   TRUE 
  2138 105498 
NULL
[1] "cleanck"

FALSE  TRUE 
 8897 98739 
NULL
[1] "impfloor"

FALSE  TRUE 
38929 68707 
NULL
[1] "nrooms"

FALSE  TRUE 
44866 62770 
[1] "4+" "1"  "2"  "3" 
[1] "nhh"

 FALSE   TRUE 
  4199 103437 
[1] "3 or less" "4-5"       "6-7"       "8+"       
[1] "nchldlt5"

FALSE  TRUE 
38631 69005 
[1] "1"  "2+"
[1] "ses"

 FALSE   TRUE 
107476    160 
NULL
[1] "earlybf"

FALSE  TRUE 
60466 47170 
NULL
[1] "hfoodsec"

FALSE  TRUE 
28392 79244 
[1] "Food Secure"          "Mildly Food Insecure" "Food Insecure"       
[1] "measurefreq"

 FALSE 
107636 
NULL
[1] "anywast06"

FALSE  TRUE 
10927 96709 
NULL
[1] "pers_wast"

FALSE  TRUE 
10211 97425 
NULL
[1] "enstunt"

FALSE  TRUE 
87288 20348 
[1] "0" "1"
[1] "enwast"

FALSE  TRUE 
80244 27392 
NULL
[1] "hhwealth_quart"

FALSE  TRUE 
44282 63354 
[1] "WealthQ4" "WealthQ3" "WealthQ2" "WealthQ1"
[1] "id"

 FALSE 
107636 
NULL
[1] "W_gagebrth"

FALSE  TRUE 
50537 57099 
NULL
[1] "W_birthwt"

FALSE  TRUE 
79038 28598 
NULL
[1] "W_birthlen"

FALSE  TRUE 
71944 35692 
NULL
[1] "W_mage"

FALSE  TRUE 
97898  9738 
NULL
[1] "W_mhtcm"

FALSE  TRUE 
83198 24438 
NULL
[1] "W_mwtkg"

FALSE  TRUE 
82073 25563 
NULL
[1] "W_mbmi"

FALSE  TRUE 
79813 27823 
NULL
[1] "W_fage"

FALSE  TRUE 
30118 77518 
NULL
[1] "W_fhtcm"

FALSE  TRUE 
20636 87000 
NULL
[1] "W_meducyrs"

FALSE  TRUE 
96984 10652 
NULL
[1] "W_feducyrs"

FALSE  TRUE 
86007 21629 
NULL
[1] "W_nrooms"

FALSE  TRUE 
44866 62770 
NULL
[1] "W_nhh"

 FALSE   TRUE 
  4199 103437 
NULL
[1] "W_nchldlt5"

FALSE  TRUE 
38631 69005 
NULL
[1] "W_parity"

FALSE  TRUE 
64927 42709 
NULL
> 
> 
> 
> #--------------------------------------------
> # Check for sparsity across RF levels
> #--------------------------------------------
> 
> tabRF <- function(d, Avar){
+   tab <- table(paste0(d$studyid, " ",d$country), d[,Avar])
+   tab <- tab[rowSums(tab)!=0, ]
+   print(tab)
+ }
> 
> 
> 
> 
> 
> tabRF(d, "gagebrth")
                                             
                                              Full or late term Preterm
  CMC-V-BCS-2002 INDIA                                      215      52
  iLiNS-DYAD-M MALAWI                                       809     105
  IRC INDIA                                                 250      42
  JiVitA-3 BANGLADESH                                     13683    5811
  Keneba GAMBIA                                             847     257
  NIH-Crypto BANGLADESH                                     168     265
  PROBIT BELARUS                                           8699     598
  TanzaniaChild2 TANZANIA, UNITED REPUBLIC OF              1393     350
                                             
                                              Early term
  CMC-V-BCS-2002 INDIA                                84
  iLiNS-DYAD-M MALAWI                                324
  IRC INDIA                                           98
  JiVitA-3 BANGLADESH                               7289
  Keneba GAMBIA                                      609
  NIH-Crypto BANGLADESH                              325
  PROBIT BELARUS                                    7749
  TanzaniaChild2 TANZANIA, UNITED REPUBLIC OF        515
> tabRF(d, "birthwt")
                                             
                                              Normal or high birthweight
  CMC-V-BCS-2002 INDIA                                               322
  CMIN Bangladesh93 BANGLADESH                                         6
  CMIN Brazil89 BRAZIL                                               108
  CMIN GB94 GUINEA-BISSAU                                              6
  CMIN Peru89 PERU                                                     5
  CMIN Peru95 PERU                                                    10
  CONTENT PERU                                                         2
  EE PAKISTAN                                                        245
  GMS-Nepal NEPAL                                                     96
  iLiNS-DYAD-M MALAWI                                                961
  IRC INDIA                                                          335
  JiVitA-3 BANGLADESH                                              12990
  JiVitA-4 BANGLADESH                                               3330
  Keneba GAMBIA                                                     1805
  MAL-ED BANGLADESH                                                  203
  MAL-ED BRAZIL                                                      221
  MAL-ED INDIA                                                       205
  MAL-ED NEPAL                                                       212
  MAL-ED PERU                                                        279
  MAL-ED SOUTH AFRICA                                                290
  MAL-ED TANZANIA, UNITED REPUBLIC OF                                125
  NIH-Birth BANGLADESH                                               409
  NIH-Crypto BANGLADESH                                              581
  PROBIT BELARUS                                                   17046
  PROVIDE BANGLADESH                                                 532
  ResPak PAKISTAN                                                     34
  SAS-CompFeed INDIA                                                7159
  TanzaniaChild2 TANZANIA, UNITED REPUBLIC OF                       2293
  TDC INDIA                                                          133
  VITAMIN-A INDIA                                                      4
  ZVITAMBO ZIMBABWE                                                12120
                                             
                                              Low birthweight
  CMC-V-BCS-2002 INDIA                                     43
  CMIN Bangladesh93 BANGLADESH                              8
  CMIN Brazil89 BRAZIL                                      7
  CMIN GB94 GUINEA-BISSAU                                   0
  CMIN Peru89 PERU                                          0
  CMIN Peru95 PERU                                          0
  CONTENT PERU                                              0
  EE PAKISTAN                                             134
  GMS-Nepal NEPAL                                          44
  iLiNS-DYAD-M MALAWI                                     160
  IRC INDIA                                                69
  JiVitA-3 BANGLADESH                                    9924
  JiVitA-4 BANGLADESH                                    1179
  Keneba GAMBIA                                           313
  MAL-ED BANGLADESH                                        55
  MAL-ED BRAZIL                                            12
  MAL-ED INDIA                                             40
  MAL-ED NEPAL                                             21
  MAL-ED PERU                                              20
  MAL-ED SOUTH AFRICA                                      24
  MAL-ED TANZANIA, UNITED REPUBLIC OF                       7
  NIH-Birth BANGLADESH                                    195
  NIH-Crypto BANGLADESH                                   177
  PROBIT BELARUS                                            0
  PROVIDE BANGLADESH                                      168
  ResPak PAKISTAN                                           8
  SAS-CompFeed INDIA                                     2324
  TanzaniaChild2 TANZANIA, UNITED REPUBLIC OF              82
  TDC INDIA                                                18
  VITAMIN-A INDIA                                           1
  ZVITAMBO ZIMBABWE                                      1938
> tabRF(d, "birthlen")
                              
                               >=50 cm <48 cm [48-50) cm
  CMC-V-BCS-2002 INDIA              15     49         40
  CMIN Bangladesh93 BANGLADESH       2     11          0
  CMIN Brazil89 BRAZIL              53     25         37
  CMIN GB94 GUINEA-BISSAU            1      2          3
  CMIN Peru89 PERU                   3      0          2
  CMIN Peru95 PERU                   9      0          1
  CONTENT PERU                       1      1          0
  GMS-Nepal NEPAL                   19     88         33
  iLiNS-DYAD-M MALAWI                0      1          0
  IRC INDIA                        142    111        138
  JiVitA-3 BANGLADESH             1218  16203       5066
  JiVitA-4 BANGLADESH             1232   2174       1077
  Keneba GAMBIA                    764    293        495
  MAL-ED BANGLADESH                  6     38         10
  NIH-Birth BANGLADESH             122    252        230
  NIH-Crypto BANGLADESH            168    292        298
  PROBIT BELARUS                 15444    192       1410
  PROVIDE BANGLADESH               169    248        283
  ResPak PAKISTAN                   10     19         13
  SAS-CompFeed INDIA              1406   5050       3004
  TDC INDIA                          6      8          8
  ZVITAMBO ZIMBABWE               4126   4482       5341
> tabRF(d, "parity") 
                                             
                                                  1     2    3+
  Burkina Faso Zn BURKINA FASO                 1321  1197  3727
  GMS-Nepal NEPAL                               211   181   306
  iLiNS-DYAD-M MALAWI                           224   279   735
  JiVitA-3 BANGLADESH                         10849  9236  8215
  Keneba GAMBIA                                 241   215  1544
  PROVIDE BANGLADESH                            271   244   185
  SAS-CompFeed INDIA                           2807  2214  4520
  SAS-FoodSuppl INDIA                            21    77   320
  TanzaniaChild2 TANZANIA, UNITED REPUBLIC OF   776   459   289
  TDC INDIA                                      48    64    48
  ZVITAMBO ZIMBABWE                            6087  4218  3798
> tabRF(d, "mage")
                                             
                                              [20-30)   <20  >=30
  Burkina Faso Zn BURKINA FASO                   3069   848  2328
  CMC-V-BCS-2002 INDIA                            296    34    43
  EE PAKISTAN                                     162     1   214
  GMS-Nepal NEPAL                                 447   149   102
  Guatemala BSC GUATEMALA                         175    47    59
  iLiNS-DOSE MALAWI                              1080   301   469
  iLiNS-DYAD-M MALAWI                             687   293   258
  iLiNS-Zinc BURKINA FASO                        1743   403  1033
  IRC INDIA                                       344    37    29
  JiVitA-3 BANGLADESH                           13101 12765  2422
  Keneba GAMBIA                                  1455   399  1042
  LCNI-5 MALAWI                                   364   108   198
  MAL-ED BANGLADESH                               182    37    46
  MAL-ED BRAZIL                                   139    43    51
  MAL-ED INDIA                                    194    34    21
  MAL-ED NEPAL                                    189     5    46
  MAL-ED PERU                                     153    83    67
  MAL-ED SOUTH AFRICA                             161    48   105
  MAL-ED TANZANIA, UNITED REPUBLIC OF             140    16   106
  NIH-Birth BANGLADESH                            422    73   132
  NIH-Crypto BANGLADESH                           494   136   128
  PROBIT BELARUS                                12244  1769  3032
  PROVIDE BANGLADESH                              493    85   122
  SAS-CompFeed INDIA                             7276  1227  1038
  SAS-FoodSuppl INDIA                             290    36    92
  TanzaniaChild2 TANZANIA, UNITED REPUBLIC OF    1574   167   639
  VITAMIN-A INDIA                                3210   254   530
  ZVITAMBO ZIMBABWE                              9461  2245  2358
> tabRF(d, "mhtcm") 
                                             
                                              >=155 cm <151 cm [151-155) cm
  Burkina Faso Zn BURKINA FASO                    5034     327          801
  Guatemala BSC GUATEMALA                           36     143           56
  iLiNS-DOSE MALAWI                               1060     398          470
  iLiNS-DYAD-M MALAWI                              686     210          335
  iLiNS-Zinc BURKINA FASO                         2900      91          226
  JiVitA-3 BANGLADESH                             4273   16825         7068
  Keneba GAMBIA                                   2035      94          328
  LCNI-5 MALAWI                                    514     131          192
  MAL-ED BANGLADESH                                 25     163           66
  MAL-ED BRAZIL                                    130      53           39
  MAL-ED INDIA                                      55     115           72
  MAL-ED NEPAL                                      41     133           64
  MAL-ED PERU                                       60     169           61
  MAL-ED SOUTH AFRICA                              204      33           33
  MAL-ED TANZANIA, UNITED REPUBLIC OF              153      51           52
  NIH-Birth BANGLADESH                             117     366          146
  NIH-Crypto BANGLADESH                            140     435          180
  PROBIT BELARUS                                 13211     125          398
  PROVIDE BANGLADESH                               138     373          158
  SAS-CompFeed INDIA                              3683    3007         2091
  SAS-FoodSuppl INDIA                               78     220          111
  TanzaniaChild2 TANZANIA, UNITED REPUBLIC OF     1492     360          511
  ZVITAMBO ZIMBABWE                               7839     574         1440
> tabRF(d, "mwtkg") 
                                             
                                              >=58 kg <52 kg [52-58) kg
  Burkina Faso Zn BURKINA FASO                   1674   2344       1926
  iLiNS-DOSE MALAWI                               419    938        567
  iLiNS-DYAD-M MALAWI                             298    553        382
  iLiNS-Zinc BURKINA FASO                         937   1201       1079
  JiVitA-3 BANGLADESH                             694  25742       1830
  LCNI-5 MALAWI                                   114    504        220
  MAL-ED BANGLADESH                                48    162         44
  MAL-ED BRAZIL                                   143     42         36
  MAL-ED INDIA                                     42    150         50
  MAL-ED NEPAL                                     80     76         82
  MAL-ED PERU                                     104    115         71
  MAL-ED SOUTH AFRICA                             194     30         46
  MAL-ED TANZANIA, UNITED REPUBLIC OF              98     99         59
  NIH-Birth BANGLADESH                             82    453         94
  NIH-Crypto BANGLADESH                           192    406        157
  PROBIT BELARUS                                10279   1131       2362
  PROVIDE BANGLADESH                              120    432        117
  SAS-CompFeed INDIA                              723   7250       1518
  TanzaniaChild2 TANZANIA, UNITED REPUBLIC OF    1478    395        483
  ZVITAMBO ZIMBABWE                              5845   2410       2953
> tabRF(d, "mbmi") 
                                             
                                              Normal weight Underweight
  Burkina Faso Zn BURKINA FASO                         5342         602
  iLiNS-DOSE MALAWI                                    1785         136
  iLiNS-DYAD-M MALAWI                                  1160          67
  iLiNS-Zinc BURKINA FASO                              2763         454
  JiVitA-3 BANGLADESH                                 17390       10775
  LCNI-5 MALAWI                                         692         145
  MAL-ED BANGLADESH                                     222          32
  MAL-ED BRAZIL                                         211          10
  MAL-ED INDIA                                          193          49
  MAL-ED NEPAL                                          238           0
  MAL-ED PERU                                           285           5
  MAL-ED SOUTH AFRICA                                   262           8
  MAL-ED TANZANIA, UNITED REPUBLIC OF                   242          14
  NIH-Birth BANGLADESH                                  523         106
  NIH-Crypto BANGLADESH                                 687          68
  PROBIT BELARUS                                      13205         523
  PROVIDE BANGLADESH                                    542         127
  SAS-CompFeed INDIA                                   6436        2345
  TanzaniaChild2 TANZANIA, UNITED REPUBLIC OF          2311          38
  ZVITAMBO ZIMBABWE                                    9303         517
> tabRF(d, "fage")
                                     
                                       >=38   <32 [32-38)
  iLiNS-DOSE MALAWI                     384   988     341
  iLiNS-DYAD-M MALAWI                   237   702     253
  LCNI-5 MALAWI                          26    56      24
  MAL-ED BANGLADESH                      69    30      52
  MAL-ED BRAZIL                          30    18      31
  MAL-ED INDIA                           36    53      72
  MAL-ED NEPAL                           17    15      47
  MAL-ED PERU                            27    29      29
  MAL-ED SOUTH AFRICA                    65     9      16
  MAL-ED TANZANIA, UNITED REPUBLIC OF    48    15      37
  PROBIT BELARUS                        749 13189    2486
  SAS-CompFeed INDIA                    309  8015    1196
  SAS-FoodSuppl INDIA                    44   289      85
> tabRF(d, "fhtcm")
                     
                      >=167 cm <162 cm [162-167) cm
  Keneba GAMBIA           1258     133          557
  PROBIT BELARUS         11744     168          625
  SAS-CompFeed INDIA      2658    1391         1703
  SAS-FoodSuppl INDIA      106     163          130
> tabRF(d, "feducyrs")
                                             
                                               High   Low Medium
  GMS-Nepal NEPAL                               173   296    227
  iLiNS-DOSE MALAWI                             698   585    525
  iLiNS-DYAD-M MALAWI                           370   443    425
  JiVitA-3 BANGLADESH                          6707 11254   9279
  JiVitA-4 BANGLADESH                          1248  1959   2076
  LCNI-5 MALAWI                                 251   291    271
  MAL-ED BANGLADESH                              54    40     55
  MAL-ED INDIA                                   44    59     44
  MAL-ED NEPAL                                   42    28     28
  MAL-ED PERU                                   120    69     61
  MAL-ED SOUTH AFRICA                            43    37     30
  MAL-ED TANZANIA, UNITED REPUBLIC OF           130    61     21
  NIH-Crypto BANGLADESH                         296   242    220
  PROBIT BELARUS                               2747  6480   7234
  PROVIDE BANGLADESH                            232   238    230
  SAS-CompFeed INDIA                           2492  3967   3061
  SAS-FoodSuppl INDIA                           110   147    161
  TanzaniaChild2 TANZANIA, UNITED REPUBLIC OF   449  1273    665
  VITAMIN-A INDIA                              1700  1194   1102
  ZVITAMBO ZIMBABWE                            1003  2316  10404
> tabRF(d, "nrooms")
                                     
                                         4+     1     2     3
  CMC-V-BCS-2002 INDIA                   14   202   106    51
  CONTENT PERU                           78    44    54    39
  GMS-Nepal NEPAL                       323    49   145   181
  iLiNS-DOSE MALAWI                     265   340   701   447
  iLiNS-DYAD-M MALAWI                    43   145   147    68
  IRC INDIA                              17   185   170    36
  JiVitA-3 BANGLADESH                  1181 16754  7605  2723
  JiVitA-4 BANGLADESH                   286  3196  1389   562
  MAL-ED BANGLADESH                      12   152    50    28
  MAL-ED BRAZIL                         127     4    20    59
  MAL-ED INDIA                           25    84    78    48
  MAL-ED NEPAL                          131    52    31    22
  MAL-ED PERU                           139    19    52    62
  MAL-ED SOUTH AFRICA                   196    14    22    25
  MAL-ED TANZANIA, UNITED REPUBLIC OF   108    13    63    66
  NIH-Crypto BANGLADESH                  95   368   191   104
  PROVIDE BANGLADESH                     23   507   108    62
  TDC INDIA                               5    91    49    15
  VITAMIN-A INDIA                       245  2536   922   297
> tabRF(d, "nhh")
                       
                        3 or less 4-5 6-7  8+
  iLiNS-DYAD-M MALAWI         115  89  67  36
  IRC INDIA                    58 158 107  87
  LCNI-5 MALAWI               225 340 182  70
  NIH-Birth BANGLADESH        117 264 142 106
  NIH-Crypto BANGLADESH       114 342 178 124
  PROVIDE BANGLADESH          140 322 151  87
  SAS-FoodSuppl INDIA          38 183 127  70
  TDC INDIA                    42  64  36  18
> tabRF(d, "nchldlt5")
                                             
                                                  1    2+
  iLiNS-DOSE MALAWI                             845   967
  iLiNS-DYAD-M MALAWI                            66   229
  iLiNS-Zinc BURKINA FASO                      1073  2116
  IRC INDIA                                      89   321
  JiVitA-3 BANGLADESH                         18200 10066
  LCNI-5 MALAWI                                 391   421
  NIH-Crypto BANGLADESH                         541   217
  PROVIDE BANGLADESH                            512   188
  TanzaniaChild2 TANZANIA, UNITED REPUBLIC OF  1640   749
> 
> 
> 
> 
> #--------------------------------------------
> # Save dataset
> #--------------------------------------------
> 
> 
> 
> saveRDS(d, temp_clean_covariates_path)
> 
> 
> 
> proc.time()
   user  system elapsed 
424.467  19.002 443.440 
